FIT Profiler Report
Profile stats for: configure_callbacks
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 lightning.py:1199(configure_callbacks)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)



Profile stats for: prepare_data
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:325(prepare_data)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_before_accelerator_backend_setup
         56 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:35(on_before_accelerator_backend_setup)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:63(on_before_accelerator_backend_setup)
        1    0.000    0.000    0.000    0.000 module.py:934(__getattr__)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: setup
         52 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:45(setup)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:67(setup)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:373(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_sharded_model
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:298(configure_sharded_model)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_configure_sharded_model
         56 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:40(on_configure_sharded_model)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 module.py:934(__getattr__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:60(on_configure_sharded_model)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_optimizers
         5543 function calls (4282 primitive calls) in 0.083 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.083    0.083 selfexplainer.py:227(configure_optimizers)
        1    0.000    0.000    0.083    0.083 adam.py:34(__init__)
        1    0.002    0.002    0.083    0.083 optimizer.py:34(__init__)
      183    0.003    0.000    0.062    0.000 module.py:1240(parameters)
      183    0.003    0.000    0.059    0.000 module.py:1264(named_parameters)
      183    0.007    0.000    0.057    0.000 module.py:1227(_named_members)
 1451/190    0.023    0.000    0.029    0.000 module.py:1394(named_modules)
      752    0.017    0.000    0.028    0.000 tensor.py:593(__hash__)
        1    0.004    0.004    0.019    0.019 optimizer.py:232(add_param_group)
      371    0.004    0.000    0.012    0.000 {method 'add' of 'set' objects}
      758    0.006    0.000    0.006    0.000 {built-in method builtins.id}
      752    0.005    0.000    0.005    0.000 {built-in method torch._C._has_torch_function_unary}
      189    0.003    0.000    0.004    0.000 module.py:1285(<lambda>)
      378    0.003    0.000    0.003    0.000 {method 'items' of 'collections.OrderedDict' objects}
        6    0.001    0.000    0.003    0.000 metric.py:575(__hash__)
      211    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.001    0.000 {built-in method builtins.hash}
        1    0.000    0.000    0.000    0.000 optimizer.py:79(_hook_for_profile)
       34    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 optimizer.py:82(profile_hook_step)
        1    0.000    0.000    0.000    0.000 functools.py:34(update_wrapper)
       25    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       25    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        5    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 functools.py:64(wraps)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: on_fit_start
         55 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:65(on_fit_start)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:83(on_fit_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:28(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_pretrain_routine_start
         21798 function calls (16944 primitive calls) in 0.385 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.385    0.385 callback_hook.py:145(on_pretrain_routine_start)
        1    0.000    0.000    0.378    0.378 model_summary.py:52(on_pretrain_routine_start)
        9    0.007    0.001    0.369    0.041 {built-in method builtins.sum}
      736    0.012    0.000    0.283    0.000 module.py:1240(parameters)
      736    0.012    0.000    0.271    0.000 module.py:1264(named_parameters)
      736    0.033    0.000    0.258    0.000 module.py:1227(_named_members)
        2    0.000    0.000    0.182    0.091 model_summary.py:250(total_parameters)
      366    0.013    0.000    0.178    0.000 model_summary.py:252(<genexpr>)
 5614/763    0.106    0.000    0.131    0.000 module.py:1394(named_modules)
        1    0.000    0.000    0.101    0.101 model_summary.py:307(_get_summary_data)
        1    0.000    0.000    0.100    0.100 model_summary.py:246(param_nums)
        1    0.000    0.000    0.100    0.100 model_summary.py:248(<listcomp>)
        5    0.000    0.000    0.100    0.020 model_summary.py:124(num_parameters)
      187    0.006    0.000    0.098    0.001 model_summary.py:127(<genexpr>)
        1    0.000    0.000    0.091    0.091 model_summary.py:260(model_size)
        1    0.000    0.000    0.087    0.087 model_summary.py:254(trainable_parameters)
      183    0.007    0.000    0.085    0.000 model_summary.py:256(<genexpr>)
     1576    0.040    0.000    0.067    0.000 tensor.py:593(__hash__)
     1488    0.019    0.000    0.058    0.000 {method 'add' of 'set' objects}
      182    0.004    0.000    0.027    0.000 <__array_function__ internals>:2(prod)
      182    0.003    0.000    0.022    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}
      728    0.014    0.000    0.020    0.000 model_summary.py:433(_is_lazy_weight_tensor)
      755    0.013    0.000    0.019    0.000 module.py:1285(<lambda>)
      182    0.003    0.000    0.019    0.000 fromnumeric.py:2881(prod)
      182    0.007    0.000    0.016    0.000 fromnumeric.py:70(_wrapreduction)
       30    0.005    0.000    0.015    0.001 metric.py:575(__hash__)
     1606    0.014    0.000    0.014    0.000 {built-in method builtins.id}
     1576    0.013    0.000    0.013    0.000 {built-in method torch._C._has_torch_function_unary}
     1511    0.013    0.000    0.013    0.000 {method 'items' of 'collections.OrderedDict' objects}
      887    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
       30    0.001    0.000    0.006    0.000 {built-in method builtins.hash}
        1    0.000    0.000    0.006    0.006 model_checkpoint.py:271(on_pretrain_routine_start)
      546    0.005    0.000    0.005    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.004    0.004 model_checkpoint.py:590(__resolve_ckpt_dir)
      182    0.004    0.000    0.004    0.000 {method 'reduce' of 'numpy.ufunc' objects}
        1    0.000    0.000    0.004    0.004 model_summary.py:446(summarize)
        1    0.000    0.000    0.004    0.004 model_summary.py:191(__init__)
        1    0.000    0.000    0.004    0.004 model_summary.py:265(summarize)
        1    0.000    0.000    0.004    0.004 model_summary.py:65(summarize)
        1    0.000    0.000    0.003    0.003 model_summary.py:217(named_modules)
        6    0.000    0.000    0.003    0.001 module.py:1347(named_children)
        1    0.000    0.000    0.003    0.003 local.py:45(makedirs)
      308    0.003    0.000    0.003    0.000 {built-in method builtins.getattr}
      4/1    0.001    0.000    0.003    0.003 os.py:198(makedirs)
        1    0.001    0.001    0.002    0.002 model_summary.py:348(_format_summary_table)
        1    0.000    0.000    0.002    0.002 model_checkpoint.py:629(__warn_if_dir_not_empty)
        1    0.000    0.000    0.001    0.001 __init__.py:1424(info)
      182    0.001    0.000    0.001    0.000 fromnumeric.py:71(<dictcomp>)
      182    0.001    0.000    0.001    0.000 fromnumeric.py:2876(_prod_dispatcher)
      182    0.001    0.000    0.001    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.001    0.001 __init__.py:1553(_log)
      154    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
        4    0.001    0.000    0.001    0.000 posixpath.py:100(split)
      124    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.001    0.000 local.py:182(_strip_protocol)
        8    0.000    0.000    0.001    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.001    0.001 spec.py:622(isdir)
        1    0.000    0.000    0.001    0.001 local.py:65(info)
        1    0.000    0.000    0.001    0.001 __init__.py:1579(handle)
        1    0.000    0.000    0.001    0.001 __init__.py:1538(makeRecord)
        1    0.000    0.000    0.001    0.001 local.py:53(ls)
        1    0.000    0.000    0.001    0.001 trainer.py:1859(weights_save_path)
        8    0.000    0.000    0.001    0.000 model_summary.py:396(get_human_readable_count)
        1    0.000    0.000    0.001    0.001 __init__.py:1633(callHandlers)
       24    0.000    0.000    0.001    0.000 model_summary.py:362(<genexpr>)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        6    0.000    0.000    0.001    0.000 model_summary.py:266(<genexpr>)
        2    0.000    0.000    0.001    0.000 cloud_io.py:41(get_filesystem)
        1    0.000    0.000    0.001    0.001 __init__.py:937(handle)
        4    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
        2    0.000    0.000    0.000    0.000 spec.py:53(__call__)
        1    0.000    0.000    0.000    0.000 __init__.py:284(__init__)
        1    0.000    0.000    0.000    0.000 trainer.py:1849(default_root_dir)
        2    0.000    0.000    0.000    0.000 posixpath.py:334(normpath)
        3    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        5    0.000    0.000    0.000    0.000 model_summary.py:70(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
        1    0.000    0.000    0.000    0.000 __init__.py:1069(emit)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        5    0.000    0.000    0.000    0.000 model_summary.py:80(_register_hook)
        6    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
       28    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 model_summary.py:103(detach_hook)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 model_summary.py:77(__del__)
        5    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        2    0.000    0.000    0.000    0.000 trainer.py:1777(is_global_zero)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 posixpath.py:71(join)
        1    0.000    0.000    0.000    0.000 __init__.py:914(format)
       13    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 utils.py:270(tokenize)
        2    0.000    0.000    0.000    0.000 trainer.py:1623(global_rank)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 __init__.py:651(format)
        3    0.000    0.000    0.000    0.000 utils.py:290(stringify_path)
       10    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        5    0.000    0.000    0.000    0.000 module.py:823(register_forward_hook)
        1    0.000    0.000    0.000    0.000 __init__.py:1677(isEnabledFor)
        1    0.000    0.000    0.000    0.000 model_summary.py:234(layer_types)
        1    0.000    0.000    0.000    0.000 __init__.py:1058(flush)
       10    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        7    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:1502(findCaller)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 posixpath.py:117(splitext)
        7    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
        2    0.000    0.000    0.000    0.000 config.py:66(apply_config)
        1    0.000    0.000    0.000    0.000 model_summary.py:369(<listcomp>)
       10    0.000    0.000    0.000    0.000 hooks.py:21(remove)
        1    0.000    0.000    0.000    0.000 model_summary.py:236(<listcomp>)
        1    0.000    0.000    0.000    0.000 model_summary.py:274(<listcomp>)
        1    0.000    0.000    0.000    0.000 posixpath.py:140(basename)
        1    0.000    0.000    0.000    0.000 {built-in method posix.listdir}
        3    0.000    0.000    0.000    0.000 {built-in method posix.getcwd}
        8    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:901(release)
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:894(acquire)
        1    0.000    0.000    0.000    0.000 __init__.py:214(_acquireLock)
        1    0.000    0.000    0.000    0.000 __init__.py:635(formatMessage)
        5    0.000    0.000    0.000    0.000 hooks.py:16(__init__)
        1    0.000    0.000    0.000    0.000 __init__.py:629(usesTime)
        1    0.000    0.000    0.000    0.000 genericpath.py:121(_splitext)
        5    0.000    0.000    0.000    0.000 model_summary.py:119(layer_type)
        5    0.000    0.000    0.000    0.000 {method 'count' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 __init__.py:434(format)
        1    0.000    0.000    0.000    0.000 __init__.py:119(getLevelName)
        3    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 __init__.py:156(<lambda>)
        1    0.000    0.000    0.000    0.000 __init__.py:423(usesTime)
        1    0.000    0.000    0.000    0.000 posixpath.py:52(normcase)
        3    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:223(_releaseLock)
        1    0.000    0.000    0.000    0.000 threading.py:1306(current_thread)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 model_summary.py:230(layer_names)
        2    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
        3    0.000    0.000    0.000    0.000 base.py:238(on_pretrain_routine_start)
        2    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 local.py:59(<listcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISLNK}
        1    0.000    0.000    0.000    0.000 hooks.py:64(on_pretrain_routine_start)
        2    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
        1    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
        2    0.000    0.000    0.000    0.000 __init__.py:792(filter)
        2    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 spec.py:55(<genexpr>)
        2    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 lightning.py:186(example_input_array)
        1    0.000    0.000    0.000    0.000 __init__.py:431(_format)
        1    0.000    0.000    0.000    0.000 __init__.py:1663(getEffectiveLevel)
        1    0.000    0.000    0.000    0.000 model_summary.py:392(get_formatted_model_size)
        1    0.000    0.000    0.000    0.000 __init__.py:360(getMessage)
        1    0.000    0.000    0.000    0.000 tensorboard.py:137(save_dir)
        1    0.000    0.000    0.000    0.000 threading.py:1031(name)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 process.py:189(name)
        1    0.000    0.000    0.000    0.000 {method 'find' of 'str' objects}
        1    0.000    0.000    0.000    0.000 tensorboard.py:272(name)
        1    0.000    0.000    0.000    0.000 process.py:37(current_process)
        1    0.000    0.000    0.000    0.000 {built-in method sys._getframe}
        1    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
        1    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)
        1    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}



Profile stats for: on_pretrain_routine_end
         55 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.002    0.002 callback_hook.py:150(on_pretrain_routine_end)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:242(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:73(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_sanity_check_start
         618 function calls in 0.012 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.012    0.012 callback_hook.py:75(on_sanity_check_start)
        1    0.000    0.000    0.011    0.011 tqdm_progress.py:209(on_sanity_check_start)
        1    0.000    0.000    0.010    0.010 tqdm_progress.py:143(init_sanity_tqdm)
        2    0.000    0.000    0.007    0.004 std.py:557(__new__)
        2    0.000    0.000    0.005    0.003 std.py:654(get_lock)
        1    0.000    0.000    0.005    0.005 std.py:92(__init__)
        1    0.000    0.000    0.005    0.005 std.py:118(create_mp_lock)
        1    0.000    0.000    0.005    0.005 context.py:70(RLock)
        1    0.000    0.000    0.004    0.004 <frozen importlib._bootstrap>:986(_find_and_load)
        2    0.000    0.000    0.004    0.002 tqdm_progress.py:35(__init__)
        2    0.000    0.000    0.003    0.002 std.py:828(__init__)
        1    0.000    0.000    0.003    0.003 <frozen importlib._bootstrap>:956(_find_and_load_unlocked)
        1    0.000    0.000    0.002    0.002 <frozen importlib._bootstrap>:650(_load_unlocked)
        1    0.000    0.000    0.002    0.002 std.py:1360(refresh)
        1    0.000    0.000    0.002    0.002 std.py:1491(display)
        1    0.000    0.000    0.002    0.002 <frozen importlib._bootstrap_external>:777(exec_module)
        1    0.000    0.000    0.002    0.002 std.py:336(print_status)
        1    0.000    0.000    0.001    0.001 utils.py:325(disp_len)
        1    0.000    0.000    0.001    0.001 utils.py:320(_text_width)
        1    0.000    0.000    0.001    0.001 {built-in method builtins.sum}
        1    0.000    0.000    0.001    0.001 synchronize.py:186(__init__)
        1    0.000    0.000    0.001    0.001 synchronize.py:50(__init__)
        1    0.000    0.000    0.001    0.001 _monitor.py:29(__init__)
       44    0.001    0.000    0.001    0.000 utils.py:321(<genexpr>)
        3    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.001    0.001 synchronize.py:114(_make_name)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:890(_find_spec)
        1    0.000    0.000    0.001    0.001 tempfile.py:144(__next__)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap_external>:849(get_code)
        1    0.000    0.000    0.001    0.001 threading.py:834(start)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap_external>:1334(find_spec)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:211(_call_with_frames_removed)
        1    0.000    0.000    0.001    0.001 {built-in method builtins.exec}
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap_external>:1302(_get_spec)
        1    0.000    0.000    0.001    0.001 tempfile.py:147(<listcomp>)
        1    0.000    0.000    0.001    0.001 synchronize.py:11(<module>)
        1    0.000    0.000    0.001    0.001 threading.py:540(wait)
        8    0.000    0.000    0.001    0.000 random.py:285(choice)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap_external>:1431(find_spec)
        1    0.000    0.000    0.001    0.001 threading.py:270(wait)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:549(module_from_spec)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:477(_init_module_attrs)
        4    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
        6    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:62(_path_join)
       43    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        8    0.000    0.000    0.000    0.000 random.py:250(_randbelow_with_getrandbits)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:294(cache_from_source)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.__build_class__}
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 std.py:1126(__repr__)
        2    0.000    0.000    0.000    0.000 utils.py:154(__init__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:376(cached)
        1    0.000    0.000    0.000    0.000 std.py:573(_get_free_pos)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:424(_get_cached)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:578(_compile_bytecode)
        4    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        6    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:64(<listcomp>)
        5    0.000    0.000    0.000    0.000 std.py:104(acquire)
        4    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        1    0.000    0.000    0.000    0.000 threading.py:761(__init__)
        1    0.000    0.000    0.000    0.000 tempfile.py:133(rng)
        2    0.000    0.000    0.000    0.000 std.py:576(<genexpr>)
        5    0.000    0.000    0.000    0.000 std.py:108(release)
       17    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method marshal.loads}
        5    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:389(parent)
        2    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 std.py:343(format_meter)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1017(_handle_fromlist)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:969(get_data)
        1    0.000    0.000    0.000    0.000 random.py:94(__init__)
        3    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
       17    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        3    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        1    0.000    0.000    0.000    0.000 random.py:123(seed)
        1    0.000    0.000    0.000    0.000 {built-in method _thread.start_new_thread}
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 util.py:171(register_after_fork)
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:51(_unpack_uint32)
        1    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:68(_path_split)
       14    0.000    0.000    0.000    0.000 {method 'getrandbits' of '_random.Random' objects}
       14    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:80(_path_stat)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:526(_validate_timestamp_pyc)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        1    0.000    0.000    0.000    0.000 std.py:330(fp_write)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
        2    0.000    0.000    0.000    0.000 threading.py:505(__init__)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {function Random.seed at 0x7fe64f25ca60}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       12    0.000    0.000    0.000    0.000 {method 'rpartition' of 'str' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:1426(_get_spec)
        8    0.000    0.000    0.000    0.000 {method 'bit_length' of 'int' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:493(_classify_pyc)
        1    0.000    0.000    0.000    0.000 utils.py:207(_supports_unicode)
        2    0.000    0.000    0.000    0.000 std.py:1129(_comparable)
        2    0.000    0.000    0.000    0.000 utils.py:141(inner)
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        9    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        3    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 weakref.py:159(__setitem__)
        3    0.000    0.000    0.000    0.000 std.py:1133(__hash__)
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:867(__exit__)
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:863(__enter__)
        5    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 std.py:260(format_interval)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:99(_path_isfile)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        7    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:222(_verbose_message)
        2    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        6    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        3    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:629(spec_from_file_location)
        6    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method io.open_code}
        2    0.000    0.000    0.000    0.000 utils.py:163(__eq__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:90(_path_is_mode_type)
        6    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 synchronize.py:360(Barrier)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
        1    0.000    0.000    0.000    0.000 {method 'read' of '_io.BufferedReader' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:1010(path_stats)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:133(is_disabled)
        4    0.000    0.000    0.000    0.000 base.py:91(on_sanity_check_start)
        4    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        5    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        5    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
        5    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
        4    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 threading.py:222(__init__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:1265(_path_importer_cache)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 module.py:934(__getattr__)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 utils.py:193(_is_utf)
        1    0.000    0.000    0.000    0.000 threading.py:246(__enter__)
        1    0.000    0.000    0.000    0.000 threading.py:249(__exit__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:800(find_spec)
        1    0.000    0.000    0.000    0.000 weakref.py:323(__new__)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        1    0.000    0.000    0.000    0.000 threading.py:261(_is_owned)
        1    0.000    0.000    0.000    0.000 std.py:320(status_printer)
        1    0.000    0.000    0.000    0.000 threading.py:1110(daemon)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:456(_check_name_wrapper)
        1    0.000    0.000    0.000    0.000 _monitor.py:92(report)
        1    0.000    0.000    0.000    0.000 threading.py:258(_acquire_restore)
        3    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        1    0.000    0.000    0.000    0.000 threading.py:255(_release_save)
        3    0.000    0.000    0.000    0.000 {built-in method from_bytes}
        1    0.000    0.000    0.000    0.000 threading.py:1306(current_thread)
        3    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        3    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        3    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        2    0.000    0.000    0.000    0.000 {method 'setter' of 'property' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 synchronize.py:46(SemLock)
        1    0.000    0.000    0.000    0.000 threading.py:1177(_make_invoke_excepthook)
        1    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:342(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method _imp._fix_co_filename}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:939(__init__)
        1    0.000    0.000    0.000    0.000 context.py:233(get_context)
        1    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 threading.py:734(_newname)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 synchronize.py:210(Condition)
        1    0.000    0.000    0.000    0.000 synchronize.py:90(_make_methods)
        1    0.000    0.000    0.000    0.000 weakref.py:328(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:35(_new_module)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        1    0.000    0.000    0.000    0.000 util.py:48(debug)
        1    0.000    0.000    0.000    0.000 threading.py:1095(daemon)
        1    0.000    0.000    0.000    0.000 synchronize.py:321(Event)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 {built-in method atexit.register}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'difference' of 'set' objects}
        1    0.000    0.000    0.000    0.000 utils.py:223(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:125(process_position)
        1    0.000    0.000    0.000    0.000 context.py:197(get_start_method)
        1    0.000    0.000    0.000    0.000 synchronize.py:123(Semaphore)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method _imp.is_frozen}
        1    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 synchronize.py:184(RLock)
        1    0.000    0.000    0.000    0.000 std.py:100(<listcomp>)
        1    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 synchronize.py:142(BoundedSemaphore)
        1    0.000    0.000    0.000    0.000 synchronize.py:159(Lock)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 process.py:37(current_process)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:40(_relax_case)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:397(has_location)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:725(find_spec)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:774(create_module)
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:964(get_filename)



Profile stats for: on_val_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:628(on_val_dataloader)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_model_eval
         5324 function calls (4948 primitive calls) in 0.081 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.081    0.041 hooks.py:164(on_validation_model_eval)
        2    0.000    0.000    0.081    0.040 module.py:1452(eval)
    378/2    0.015    0.000    0.081    0.040 module.py:1432(train)
      754    0.011    0.000    0.034    0.000 module.py:1338(children)
      378    0.017    0.000    0.031    0.000 module.py:950(__setattr__)
      754    0.012    0.000    0.023    0.000 module.py:1347(named_children)
     1136    0.008    0.000    0.008    0.000 {method 'get' of 'dict' objects}
      804    0.006    0.000    0.006    0.000 {built-in method builtins.isinstance}
       12    0.002    0.000    0.006    0.000 metric.py:575(__hash__)
      376    0.003    0.000    0.005    0.000 {method 'add' of 'set' objects}
      378    0.003    0.000    0.003    0.000 {method 'items' of 'collections.OrderedDict' objects}
       12    0.000    0.000    0.002    0.000 {built-in method builtins.hash}
       48    0.001    0.000    0.002    0.000 tensor.py:593(__hash__)
        6    0.000    0.000    0.001    0.000 metric.py:430(__setattr__)
       60    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       52    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       50    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       48    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       48    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 trainer.py:1735(model)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 accelerator.py:159(model)
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)



Profile stats for: on_validation_start
         1900 function calls in 0.029 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.029    0.014 callback_hook.py:213(on_validation_start)
        2    0.000    0.000    0.027    0.014 tqdm_progress.py:247(on_validation_start)
        3    0.000    0.000    0.025    0.008 std.py:1360(refresh)
        3    0.000    0.000    0.025    0.008 std.py:1491(display)
        2    0.000    0.000    0.023    0.012 tqdm_progress.py:347(reset)
        2    0.000    0.000    0.023    0.012 std.py:1393(reset)
        7    0.000    0.000    0.021    0.003 utils.py:325(disp_len)
        7    0.000    0.000    0.021    0.003 utils.py:320(_text_width)
        9    0.005    0.001    0.021    0.002 {built-in method builtins.sum}
      716    0.010    0.000    0.015    0.000 utils.py:321(<genexpr>)
        3    0.000    0.000    0.014    0.005 std.py:1126(__repr__)
        3    0.001    0.000    0.013    0.004 std.py:343(format_meter)
        3    0.000    0.000    0.010    0.003 std.py:336(print_status)
        2    0.000    0.000    0.009    0.004 utils.py:333(disp_trim)
      709    0.005    0.000    0.005    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.003    0.003 tqdm_progress.py:183(init_validation_tqdm)
        1    0.000    0.000    0.003    0.003 tqdm_progress.py:35(__init__)
        1    0.000    0.000    0.002    0.002 std.py:828(__init__)
       11    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
       11    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        4    0.000    0.000    0.001    0.000 utils.py:214(_is_ascii)
       11    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       14    0.000    0.000    0.001    0.000 utils.py:141(inner)
        4    0.000    0.000    0.000    0.000 std.py:1468(moveto)
        3    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
       11    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        3    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        1    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        2    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
        4    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
       13    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 std.py:557(__new__)
        3    0.000    0.000    0.000    0.000 std.py:330(fp_write)
       32    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 trainer.py:1842(enable_validation)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        4    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        5    0.000    0.000    0.000    0.000 std.py:108(release)
        5    0.000    0.000    0.000    0.000 std.py:104(acquire)
        6    0.000    0.000    0.000    0.000 types.py:171(__get__)
        3    0.000    0.000    0.000    0.000 std.py:260(format_interval)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 utils.py:154(__init__)
        7    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
       16    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 std.py:189(__format__)
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
        5    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
       15    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        6    0.000    0.000    0.000    0.000 enum.py:689(value)
        1    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
        6    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:324(_update_bar)
        4    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:337(convert_inf)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 utils.py:207(_supports_unicode)
        8    0.000    0.000    0.000    0.000 base.py:246(on_validation_start)
        7    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        7    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        2    0.000    0.000    0.000    0.000 std.py:156(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:163(__eq__)
        6    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:133(is_disabled)
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        5    0.000    0.000    0.000    0.000 base.py:57(trainer)
        5    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        5    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 std.py:1222(update)
        4    0.000    0.000    0.000    0.000 utils.py:310(_term_move_up)
        3    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 std.py:320(status_printer)
        1    0.000    0.000    0.000    0.000 utils.py:193(_is_utf)
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        1    0.000    0.000    0.000    0.000 _monitor.py:92(report)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        1    0.000    0.000    0.000    0.000 std.py:1133(__hash__)
        1    0.000    0.000    0.000    0.000 std.py:654(get_lock)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        2    0.000    0.000    0.000    0.000 base.py:167(on_validation_start)
        2    0.000    0.000    0.000    0.000 std.py:170(colour)
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 training_type_plugin.py:335(on_validation_start)
        2    0.000    0.000    0.000    0.000 hooks.py:46(on_validation_start)
        2    0.000    0.000    0.000    0.000 std.py:166(colour)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        2    0.000    0.000    0.000    0.000 base.py:69(val_batch_idx)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {built-in method math.isnan}
        1    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 utils.py:223(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:125(process_position)
        1    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}



Profile stats for: on_epoch_start
         165 function calls in 0.003 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        3    0.000    0.000    0.002    0.001 callback_hook.py:125(on_epoch_start)
       15    0.000    0.000    0.002    0.000 trainer.py:1686(lightning_module)
       15    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       15    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       15    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
       30    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        3    0.000    0.000    0.000    0.000 base.py:68(profile)
       15    0.000    0.000    0.000    0.000 base.py:160(on_epoch_start)
       18    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        3    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 hooks.py:184(on_epoch_start)
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_epoch_start
         110 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.001    0.001 callback_hook.py:95(on_validation_epoch_start)
       10    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
       10    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 base.py:136(on_validation_epoch_start)
       12    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 hooks.py:202(on_validation_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: get_sanity_check_batch
         63 function calls (57 primitive calls) in 0.069 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      9/6    0.000    0.000    0.069    0.011 contextlib.py:108(__enter__)
      9/6    0.000    0.000    0.069    0.011 {built-in method builtins.next}
        3    0.000    0.000    0.069    0.023 fetching.py:287(apply_profiler)
        3    0.000    0.000    0.068    0.023 base.py:68(profile)
        3    0.000    0.000    0.068    0.023 advanced.py:61(start)
        3    0.068    0.023    0.068    0.023 {method 'enable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.001    0.000 contextlib.py:238(helper)
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)
        3    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)



Profile stats for: fetch_next_sanity_check_batch
         214 function calls (204 primitive calls) in 0.068 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     13/6    0.000    0.000    0.068    0.011 {built-in method builtins.next}
        3    0.000    0.000    0.068    0.023 dataloader.py:513(__next__)
        3    0.000    0.000    0.064    0.021 dataloader.py:1152(_next_data)
        3    0.000    0.000    0.063    0.021 dataloader.py:1119(_get_data)
        3    0.000    0.000    0.063    0.021 dataloader.py:973(_try_get_data)
        3    0.000    0.000    0.063    0.021 queue.py:153(get)
        3    0.000    0.000    0.062    0.021 threading.py:270(wait)
       19    0.062    0.003    0.062    0.003 {method 'acquire' of '_thread.lock' objects}
        3    0.000    0.000    0.002    0.001 profiler.py:615(__enter__)
        2    0.000    0.000    0.001    0.001 _ops.py:56(__getattr__)
        2    0.001    0.000    0.001    0.000 {built-in method torch._C._jit_get_operation}
        3    0.000    0.000    0.001    0.000 dataloader.py:1221(_process_data)
        3    0.000    0.000    0.001    0.000 dataloader.py:1201(_try_put_index)
        3    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter}
      6/3    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        3    0.000    0.000    0.000    0.000 profiler.py:619(__exit__)
        3    0.000    0.000    0.000    0.000 fetching.py:287(apply_profiler)
        3    0.000    0.000    0.000    0.000 profiler.py:607(__init__)
        3    0.000    0.000    0.000    0.000 dataloader.py:507(_next_index)
        1    0.000    0.000    0.000    0.000 queues.py:80(put)
        3    0.000    0.000    0.000    0.000 threading.py:1071(is_alive)
        4    0.000    0.000    0.000    0.000 threading.py:341(notify)
        3    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 {built-in method zeros}
        7    0.000    0.000    0.000    0.000 threading.py:261(_is_owned)
        4    0.000    0.000    0.000    0.000 threading.py:249(__exit__)
        2    0.000    0.000    0.000    0.000 _builtins.py:141(_register_builtin)
        6    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
       17    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 _ops.py:75(__getattr__)
        3    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        4    0.000    0.000    0.000    0.000 threading.py:246(__enter__)
        6    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        2    0.000    0.000    0.000    0.000 sampler.py:225(__iter__)
        3    0.000    0.000    0.000    0.000 threading.py:1017(_wait_for_tstate_lock)
        3    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_exit}
        3    0.000    0.000    0.000    0.000 threading.py:255(_release_save)
        3    0.000    0.000    0.000    0.000 queue.py:216(_get)
        3    0.000    0.000    0.000    0.000 threading.py:258(_acquire_restore)
        4    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        4    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 _builtins.py:110(_get_builtin_table)
        4    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 _ops.py:52(__init__)
        3    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        3    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
        3    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        2    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}



Profile stats for: evaluation_batch_to_device
         21982 function calls (20830 primitive calls) in 0.365 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       11    0.001    0.000    0.363    0.033 accelerator.py:192(batch_to_device)
       11    0.001    0.000    0.361    0.033 lightning.py:284(_apply_batch_transfer_handler)
       11    0.000    0.000    0.344    0.031 hooks.py:652(transfer_batch_to_device)
       11    0.000    0.000    0.344    0.031 apply_func.py:245(move_data_to_device)
  1152/11    0.082    0.000    0.344    0.031 apply_func.py:70(apply_to_collection)
     6173    0.074    0.000    0.192    0.000 {built-in method builtins.isinstance}
     3185    0.051    0.000    0.118    0.000 abc.py:96(__instancecheck__)
     3185    0.033    0.000    0.067    0.000 {built-in method _abc._abc_instancecheck}
      834    0.013    0.000    0.051    0.000 apply_func.py:65(_is_dataclass_instance)
      834    0.024    0.000    0.037    0.000 dataclasses.py:1045(is_dataclass)
      839    0.013    0.000    0.034    0.000 abc.py:100(__subclasscheck__)
      881    0.014    0.000    0.021    0.000 apply_func.py:60(_is_namedtuple)
      839    0.014    0.000    0.021    0.000 {built-in method _abc._abc_subclasscheck}
       11    0.000    0.000    0.015    0.001 signature_utils.py:18(is_param_in_hook_signature)
       11    0.000    0.000    0.015    0.001 inspect.py:3091(signature)
       11    0.000    0.000    0.015    0.001 inspect.py:2839(from_callable)
    22/11    0.001    0.000    0.014    0.001 inspect.py:2206(_signature_from_callable)
     1185    0.009    0.000    0.009    0.000 {method 'append' of 'list' objects}
       11    0.002    0.000    0.008    0.001 inspect.py:2112(_signature_from_function)
      845    0.007    0.000    0.007    0.000 {built-in method builtins.hasattr}
      834    0.007    0.000    0.007    0.000 _collections_abc.py:302(__subclasshook__)
       22    0.002    0.000    0.004    0.000 inspect.py:2760(__init__)
       44    0.001    0.000    0.003    0.000 inspect.py:2477(__init__)
       11    0.001    0.000    0.003    0.000 inspect.py:1800(_signature_bound_method)
       11    0.000    0.000    0.002    0.000 apply_func.py:262(batch_to)
       11    0.000    0.000    0.002    0.000 inspect.py:2853(replace)
      260    0.002    0.000    0.002    0.000 {method 'items' of 'dict' objects}
       11    0.002    0.000    0.002    0.000 {method 'to' of 'torch._C._TensorBase' objects}
       44    0.001    0.000    0.001    0.000 enum.py:289(__call__)
       55    0.001    0.000    0.001    0.000 inspect.py:2809(<genexpr>)
       11    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       11    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       11    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       11    0.000    0.000    0.001    0.000 inspect.py:493(unwrap)
       11    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       11    0.000    0.000    0.001    0.000 base.py:68(profile)
       77    0.001    0.000    0.001    0.000 inspect.py:2527(name)
       66    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
       22    0.000    0.000    0.001    0.000 inspect.py:158(isfunction)
       11    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
       11    0.000    0.000    0.001    0.000 advanced.py:66(stop)
       44    0.000    0.000    0.000    0.000 enum.py:586(__new__)
       55    0.000    0.000    0.000    0.000 inspect.py:2539(kind)
       11    0.000    0.000    0.000    0.000 accelerator.py:180(root_device)
       44    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       33    0.000    0.000    0.000    0.000 inspect.py:2531(default)
       11    0.000    0.000    0.000    0.000 inspect.py:513(_is_wrapper)
        4    0.000    0.000    0.000    0.000 apply_func.py:237(__subclasshook__)
       26    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       22    0.000    0.000    0.000    0.000 inspect.py:2845(parameters)
       15    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       11    0.000    0.000    0.000    0.000 single_device.py:63(root_device)
       11    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       11    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       11    0.000    0.000    0.000    0.000 hooks.py:744(on_after_batch_transfer)
       11    0.000    0.000    0.000    0.000 base.py:54(trainer)
       11    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       11    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       11    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.id}



Profile stats for: on_validation_batch_start
         605 function calls in 0.009 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       11    0.001    0.000    0.007    0.001 callback_hook.py:183(on_validation_batch_start)
       55    0.001    0.000    0.006    0.000 trainer.py:1686(lightning_module)
       55    0.001    0.000    0.004    0.000 accelerator.py:172(lightning_module)
       55    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
       55    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
       11    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
      110    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       11    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       11    0.000    0.000    0.001    0.000 base.py:68(profile)
       66    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
       55    0.000    0.000    0.000    0.000 base.py:172(on_validation_batch_start)
       11    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       11    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       22    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       22    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       11    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       11    0.000    0.000    0.000    0.000 hooks.py:103(on_validation_batch_start)
       11    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: evaluation_step_and_end
         605 function calls in 3.925 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       11    0.001    0.000    3.925    0.357 evaluation_epoch_loop.py:196(_evaluation_step)
       11    0.000    0.000    3.916    0.356 contextlib.py:108(__enter__)
       11    0.000    0.000    3.916    0.356 {built-in method builtins.next}
       11    0.000    0.000    3.916    0.356 base.py:68(profile)
       11    0.000    0.000    3.916    0.356 advanced.py:61(start)
       11    3.915    0.356    3.915    0.356 {method 'enable' of '_lsprof.Profiler' objects}
       33    0.001    0.000    0.004    0.000 trainer.py:1968(testing)
       33    0.002    0.000    0.004    0.000 enums.py:30(__eq__)
       11    0.000    0.000    0.004    0.000 evaluation_epoch_loop.py:264(_build_kwargs)
       66    0.001    0.000    0.002    0.000 types.py:171(__get__)
       11    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
       11    0.001    0.000    0.001    0.000 module.py:950(__setattr__)
       11    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       11    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       77    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       66    0.001    0.000    0.001    0.000 enum.py:689(value)
       66    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
       11    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
       55    0.000    0.000    0.000    0.000 base.py:54(trainer)
       11    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       11    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
       33    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       11    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)



Profile stats for: validation_step
         161155 function calls (149639 primitive calls) in 3.910 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       11    0.001    0.000    3.909    0.355 accelerator.py:233(validation_step)
       11    0.001    0.000    3.905    0.355 training_type_plugin.py:218(validation_step)
       11    0.002    0.000    3.904    0.355 selfexplainer.py:122(validation_step)
  7150/55    0.715    0.000    3.734    0.068 module.py:866(_call_impl)
       11    0.002    0.000    3.419    0.311 selfexplainer.py:50(forward)
       33    0.003    0.000    3.415    0.103 selfexplainer.py:60(_forward)
       33    0.001    0.000    3.171    0.096 DeepLabv3.py:10(forward)
       33    0.003    0.000    3.164    0.096 _utils.py:16(forward)
       33    0.005    0.000    2.746    0.083 _utils.py:60(forward)
  462/165    0.028    0.000    2.669    0.016 container.py:117(forward)
      528    0.126    0.000    2.169    0.004 resnet.py:121(forward)
     1980    0.258    0.000    0.766    0.000 batchnorm.py:99(forward)
     2013    0.075    0.000    0.715    0.000 conv.py:398(forward)
     2013    0.041    0.000    0.604    0.000 conv.py:390(_conv_forward)
     2013    0.563    0.000    0.563    0.000 {built-in method conv2d}
       33    0.006    0.000    0.326    0.010 deeplabv3.py:88(forward)
       11    0.002    0.000    0.292    0.027 metric.py:191(forward)
     1980    0.076    0.000    0.262    0.000 functional.py:2117(batch_norm)
    27236    0.250    0.000    0.250    0.000 module.py:934(__getattr__)
    28724    0.242    0.000    0.242    0.000 {built-in method builtins.len}
    29139    0.240    0.000    0.240    0.000 {method 'values' of 'collections.OrderedDict' objects}
       33    0.001    0.000    0.226    0.007 metric.py:259(wrapped_func)
       22    0.115    0.005    0.216    0.010 metrics.py:49(update)
       33    0.110    0.003    0.180    0.005 weighting.py:3(softmax_weighting)
7744/7557    0.067    0.000    0.159    0.000 {built-in method builtins.isinstance}
     1848    0.034    0.000    0.157    0.000 activation.py:101(forward)
       11    0.002    0.000    0.154    0.014 lightning.py:324(log)
     1199    0.022    0.000    0.130    0.000 metric.py:430(__setattr__)
       11    0.002    0.000    0.125    0.011 result.py:432(log)
     1848    0.050    0.000    0.123    0.000 functional.py:1195(relu)
     1980    0.116    0.000    0.116    0.000 {built-in method batch_norm}
   117/47    0.007    0.000    0.114    0.002 apply_func.py:70(apply_to_collection)
     1199    0.061    0.000    0.108    0.000 module.py:950(__setattr__)
        1    0.000    0.000    0.095    0.095 result.py:496(register_key)
        1    0.000    0.000    0.095    0.095 result.py:502(fn)
        1    0.000    0.000    0.086    0.086 result.py:332(to)
      276    0.004    0.000    0.074    0.000 abc.py:96(__instancecheck__)
 2038/230    0.031    0.000    0.074    0.000 abc.py:100(__subclasscheck__)
     7172    0.070    0.000    0.070    0.000 {built-in method torch._C._get_tracing_state}
      276    0.003    0.000    0.070    0.000 {built-in method _abc._abc_instancecheck}
 2038/230    0.039    0.000    0.070    0.000 {built-in method _abc._abc_subclasscheck}
       33    0.003    0.000    0.065    0.002 deeplabv3.py:58(forward)
     1980    0.035    0.000    0.054    0.000 batchnorm.py:283(_check_input_dim)
       33    0.035    0.001    0.054    0.002 helper.py:65(extract_masks)
     1980    0.035    0.000    0.052    0.000 __init__.py:31(__get__)
     1617    0.049    0.000    0.049    0.000 {built-in method relu_}
     4019    0.035    0.000    0.035    0.000 {built-in method torch._C._has_torch_function_unary}
       11    0.001    0.000    0.032    0.003 metric.py:360(wrapped_func)
     1320    0.032    0.000    0.032    0.000 {built-in method softmax}
     3755    0.029    0.000    0.029    0.000 {method 'get' of 'dict' objects}
     2596    0.024    0.000    0.024    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
      495    0.013    0.000    0.022    0.000 container.py:109(__iter__)
       66    0.009    0.000    0.021    0.000 functional.py:3364(interpolate)
     1320    0.019    0.000    0.019    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
      187    0.003    0.000    0.019    0.000 typing.py:768(__instancecheck__)
       12    0.003    0.000    0.018    0.002 metric.py:396(reset)
       11    0.000    0.000    0.018    0.002 result.py:413(_extract_batch_size)
     1320    0.018    0.000    0.018    0.000 {built-in method reshape}
     1980    0.017    0.000    0.017    0.000 {built-in method torch._C._get_cudnn_enabled}
       11    0.001    0.000    0.017    0.002 data.py:48(extract_batch_size)
       11    0.000    0.000    0.017    0.002 data.py:247(_squeeze_if_scalar)
    55/11    0.002    0.000    0.017    0.002 data.py:166(apply_to_collection)
      187    0.005    0.000    0.016    0.000 typing.py:771(__subclasscheck__)
       11    0.001    0.000    0.015    0.001 data.py:204(<dictcomp>)
   143/77    0.004    0.000    0.014    0.000 data.py:30(_extract_batch_size)
       33    0.002    0.000    0.013    0.000 loss.py:711(forward)
     78/4    0.003    0.000    0.012    0.003 copy.py:128(deepcopy)
      119    0.002    0.000    0.012    0.000 {built-in method builtins.setattr}
       11    0.007    0.001    0.011    0.001 helper.py:3(get_targets_from_annotations)
       33    0.002    0.000    0.010    0.000 functional.py:2765(binary_cross_entropy_with_logits)
      192    0.003    0.000    0.010    0.000 {built-in method builtins.issubclass}
       11    0.003    0.000    0.010    0.001 metrics.py:64(compute)
        1    0.000    0.000    0.009    0.009 result.py:205(__init__)
      231    0.008    0.000    0.008    0.000 {built-in method relu}
       33    0.007    0.000    0.007    0.000 {built-in method binary_cross_entropy_with_logits}
      132    0.007    0.000    0.007    0.000 {method 'eq' of 'torch._C._TensorBase' objects}
       33    0.001    0.000    0.006    0.000 pooling.py:1131(forward)
        1    0.000    0.000    0.006    0.006 metric.py:83(__init__)
      132    0.006    0.000    0.006    0.000 {method 'amax' of 'torch._C._TensorBase' objects}
    77/55    0.001    0.000    0.006    0.000 {built-in method builtins.next}
       33    0.002    0.000    0.006    0.000 functional.py:1022(adaptive_avg_pool2d)
       11    0.000    0.000    0.005    0.000 result.py:511(update_metrics)
       33    0.001    0.000    0.005    0.000 pooling.py:161(forward)
       11    0.000    0.000    0.005    0.000 apply_func.py:157(apply_to_collections)
       66    0.005    0.000    0.005    0.000 {built-in method torch._C._nn.upsample_bilinear2d}
       11    0.000    0.000    0.005    0.000 result.py:512(fn)
       11    0.000    0.000    0.005    0.000 trainer.py:2151(_results)
      550    0.005    0.000    0.005    0.000 {built-in method builtins.iter}
      3/2    0.000    0.000    0.005    0.002 copy.py:258(_reconstruct)
        3    0.000    0.000    0.005    0.002 {method '__reduce_ex__' of 'object' objects}
        1    0.000    0.000    0.005    0.005 result.py:182(__getstate__)
       11    0.001    0.000    0.005    0.000 trainer.py:2126(_active_loop)
       33    0.001    0.000    0.005    0.000 _jit_internal.py:355(fn)
       77    0.001    0.000    0.004    0.000 apply_func.py:65(_is_dataclass_instance)
       11    0.000    0.000    0.004    0.000 result.py:271(forward)
       33    0.001    0.000    0.004    0.000 dropout.py:57(forward)
       33    0.002    0.000    0.004    0.000 enums.py:30(__eq__)
      4/2    0.000    0.000    0.004    0.002 copy.py:226(_deepcopy_dict)
        1    0.000    0.000    0.004    0.004 dataclasses.py:1052(asdict)
     18/1    0.001    0.000    0.004    0.004 dataclasses.py:1076(_asdict_inner)
       33    0.002    0.000    0.003    0.000 functional.py:1059(dropout)
    33/22    0.001    0.000    0.003    0.000 contextlib.py:108(__enter__)
       11    0.002    0.000    0.003    0.000 result.py:223(update)
    44/33    0.001    0.000    0.003    0.000 contextlib.py:117(__exit__)
       33    0.001    0.000    0.003    0.000 functional.py:643(_max_pool2d)
       22    0.000    0.000    0.003    0.000 trainer.py:1957(training)
       77    0.002    0.000    0.003    0.000 dataclasses.py:1045(is_dataclass)
       70    0.002    0.000    0.003    0.000 grad_mode.py:200(__init__)
        1    0.000    0.000    0.003    0.003 imports.py:67(_compare_version)
       35    0.001    0.000    0.003    0.000 grad_mode.py:119(__enter__)
       11    0.003    0.000    0.003    0.000 {built-in method full}
      366    0.003    0.000    0.003    0.000 _collections_abc.py:392(__subclasshook__)
       11    0.001    0.000    0.003    0.000 loss.py:115(mask_similarity_loss)
       22    0.001    0.000    0.003    0.000 tensor.py:575(__iter__)
       33    0.003    0.000    0.003    0.000 {built-in method cat}
       66    0.002    0.000    0.002    0.000 {method 'sigmoid' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.002    0.001 metric.py:122(add_state)
       33    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.adaptive_avg_pool2d}
       44    0.001    0.000    0.002    0.000 __init__.py:46(is_available)
      245    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
       35    0.001    0.000    0.002    0.000 grad_mode.py:123(__exit__)
       33    0.002    0.000    0.002    0.000 {built-in method max_pool2d}
       44    0.002    0.000    0.002    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
       22    0.001    0.000    0.002    0.000 precision_plugin.py:238(val_step_context)
      239    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}
       22    0.000    0.000    0.002    0.000 metric.py:325(sync_context)
      189    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.002    0.000 warnings.py:41(warn)
       46    0.002    0.000    0.002    0.000 {method 'clone' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.002    0.001 tensor.py:51(__deepcopy__)
       77    0.001    0.000    0.002    0.000 apply_func.py:60(_is_namedtuple)
       66    0.001    0.000    0.002    0.000 types.py:171(__get__)
        2    0.000    0.000    0.002    0.001 result.py:595(reset)
        1    0.000    0.000    0.002    0.002 distributed.py:47(wrapped_fn)
       33    0.001    0.000    0.002    0.000 contextlib.py:238(helper)
       22    0.002    0.000    0.002    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.002    0.002 warnings.py:25(rank_zero_warn)
       11    0.000    0.000    0.002    0.000 trainer.py:2016(sanity_checking)
        1    0.000    0.000    0.002    0.002 warnings.py:21(_warn)
       24    0.001    0.000    0.002    0.000 result.py:90(_generate_sync_fn)
       66    0.002    0.000    0.002    0.000 {built-in method empty}
        1    0.000    0.000    0.002    0.002 {built-in method _warnings.warn}
      158    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
       33    0.001    0.000    0.001    0.000 container.py:186(__iter__)
        2    0.000    0.000    0.001    0.001 __init__.py:109(import_module)
       44    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.001    0.000 <string>:2(__init__)
        2    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:1002(_gcd_import)
       11    0.000    0.000    0.001    0.000 result.py:147(sync)
        1    0.000    0.000    0.001    0.001 warnings.py:96(_showwarnmsg)
        1    0.000    0.000    0.001    0.001 warnings.py:20(_showwarnmsg_impl)
        2    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:986(_find_and_load)
       11    0.000    0.000    0.001    0.000 metric.py:267(sync)
        2    0.001    0.000    0.001    0.001 version.py:292(__init__)
        1    0.000    0.000    0.001    0.001 warnings.py:117(_formatwarnmsg)
       13    0.000    0.000    0.001    0.000 result.py:57(__post_init__)
        1    0.000    0.000    0.001    0.001 inspect.py:3091(signature)
        1    0.000    0.000    0.001    0.001 warnings.py:35(_formatwarnmsg_impl)
      100    0.001    0.000    0.001    0.000 result.py:299(__setattr__)
        1    0.000    0.000    0.001    0.001 inspect.py:2839(from_callable)
       61    0.001    0.000    0.001    0.000 {method 'to' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 memory.py:41(recursive_detach)
      2/1    0.000    0.000    0.001    0.001 inspect.py:2206(_signature_from_callable)
       12    0.000    0.000    0.001    0.000 result.py:121(__post_init__)
       35    0.001    0.000    0.001    0.000 grad_mode.py:114(__init__)
       33    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
        1    0.000    0.000    0.001    0.001 linecache.py:15(getline)
        4    0.000    0.000    0.001    0.000 apply_func.py:245(move_data_to_device)
       33    0.001    0.000    0.001    0.000 _VF.py:25(__getattr__)
        1    0.000    0.000    0.001    0.001 linecache.py:37(getlines)
        1    0.000    0.000    0.001    0.001 imports.py:43(_module_available)
      123    0.001    0.000    0.001    0.000 {built-in method builtins.id}
       11    0.000    0.000    0.001    0.000 fx_validator.py:202(check_logging_and_get_default_levels)
        1    0.000    0.000    0.001    0.001 linecache.py:82(updatecache)
       33    0.001    0.000    0.001    0.000 container.py:329(items)
       33    0.001    0.000    0.001    0.000 utils.py:30(_list_with_default)
      105    0.001    0.000    0.001    0.000 {built-in method torch._C.is_grad_enabled}
       11    0.000    0.000    0.001    0.000 metric.py:41(jit_distributed_available)
       12    0.000    0.000    0.001    0.000 result.py:126(_parse_reduce_fx)
       11    0.000    0.000    0.001    0.000 result.py:74(op)
        4    0.000    0.000    0.001    0.000 dataclasses.py:1022(fields)
       57    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 metric.py:213(<dictcomp>)
       11    0.000    0.000    0.001    0.000 base.py:68(profile)
       11    0.001    0.000    0.001    0.000 {built-in method ones_like}
        2    0.000    0.000    0.001    0.000 dataclasses.py:1234(replace)
       33    0.001    0.000    0.001    0.000 {built-in method dropout}
       22    0.001    0.000    0.001    0.000 {method 'unbind' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 storage.py:44(__deepcopy__)
      2/1    0.000    0.000    0.001    0.001 copy.py:209(_deepcopy_tuple)
        5    0.000    0.000    0.001    0.000 result.py:605(fn)
       77    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
      2/1    0.000    0.000    0.001    0.001 copy.py:210(<listcomp>)
       81    0.001    0.000    0.001    0.000 _collections_abc.py:302(__subclasshook__)
        4    0.000    0.000    0.001    0.000 apply_func.py:262(batch_to)
        1    0.000    0.000    0.001    0.001 inspect.py:2112(_signature_from_function)
       21    0.000    0.000    0.001    0.000 dataclasses.py:1040(_is_dataclass_instance)
       70    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
        2    0.000    0.000    0.001    0.000 storage.py:60(clone)
        1    0.000    0.000    0.001    0.001 result.py:264(reset)
        1    0.000    0.000    0.001    0.001 tokenize.py:388(open)
       66    0.001    0.000    0.001    0.000 enum.py:689(value)
       11    0.001    0.000    0.001    0.000 {method 'abs' of 'torch._C._TensorBase' objects}
       44    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_getDeviceCount}
       11    0.000    0.000    0.001    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 metric.py:258(_wrap_update)
        1    0.000    0.000    0.000    0.000 device_dtype_mixin.py:26(__init__)
        2    0.000    0.000    0.000    0.000 functools.py:34(update_wrapper)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
       11    0.000    0.000    0.000    0.000 trainer.py:2116(_evaluation_loop)
       22    0.000    0.000    0.000    0.000 {method 'unsqueeze' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 copy.py:242(_keep_alive)
       47    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 memory.py:56(detach_and_move)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
        1    0.000    0.000    0.000    0.000 result.py:279(_wrap_compute)
       41    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
       38    0.000    0.000    0.000    0.000 dataclasses.py:1037(<genexpr>)
        1    0.000    0.000    0.000    0.000 tokenize.py:295(detect_encoding)
       10    0.000    0.000    0.000    0.000 <string>:2(__eq__)
       45    0.000    0.000    0.000    0.000 copy.py:182(_deepcopy_atomic)
       11    0.000    0.000    0.000    0.000 helper.py:53(get_target_dictionary)
        1    0.000    0.000    0.000    0.000 module.py:250(__init__)
       11    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       11    0.000    0.000    0.000    0.000 metric.py:303(unsync)
       33    0.000    0.000    0.000    0.000 _reduction.py:7(get_enum)
       35    0.000    0.000    0.000    0.000 result.py:70(op)
        2    0.000    0.000    0.000    0.000 __init__.py:216(__init__)
        9    0.000    0.000    0.000    0.000 trainer.py:2012(evaluating)
       35    0.000    0.000    0.000    0.000 _jit_internal.py:833(is_scripting)
       11    0.000    0.000    0.000    0.000 __init__.py:6(is_available)
       33    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
        6    0.000    0.000    0.000    0.000 copy.py:263(<genexpr>)
       11    0.000    0.000    0.000    0.000 helper.py:8(<listcomp>)
        2    0.000    0.000    0.000    0.000 inspect.py:2760(__init__)
        2    0.000    0.000    0.000    0.000 _utils.py:8(_get_device_index)
       11    0.000    0.000    0.000    0.000 {built-in method is_floating_point}
       22    0.000    0.000    0.000    0.000 helper.py:13(<listcomp>)
        3    0.000    0.000    0.000    0.000 inspect.py:2477(__init__)
       22    0.000    0.000    0.000    0.000 result.py:60(should)
       28    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 typing.py:255(inner)
       24    0.000    0.000    0.000    0.000 result.py:162(is_mean_reduction)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
        1    0.000    0.000    0.000    0.000 inspect.py:1800(_signature_bound_method)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
        1    0.000    0.000    0.000    0.000 {method 'readlines' of '_io._IOBase' objects}
       22    0.000    0.000    0.000    0.000 precision_plugin.py:227(forward_context)
       11    0.000    0.000    0.000    0.000 fx_validator.py:165(check_logging)
       22    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       24    0.000    0.000    0.000    0.000 result.py:80(group)
        2    0.000    0.000    0.000    0.000 version.py:495(_cmpkey)
       20    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
       11    0.000    0.000    0.000    0.000 logger_connector.py:296(should_reset_tensors)
       11    0.000    0.000    0.000    0.000 distributed_c10d.py:335(is_initialized)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
       11    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
       11    0.000    0.000    0.000    0.000 fx_validator.py:188(check_logging_levels)
        1    0.000    0.000    0.000    0.000 inspect.py:2853(replace)
        1    0.000    0.000    0.000    0.000 {built-in method _operator.ge}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 result.py:191(__setstate__)
       11    0.000    0.000    0.000    0.000 fx_validator.py:177(get_default_logging_levels)
        2    0.000    0.000    0.000    0.000 _utils.py:462(_get_device_index)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
        1    0.000    0.000    0.000    0.000 inspect.py:493(unwrap)
        2    0.000    0.000    0.000    0.000 tokenize.py:325(find_cookie)
        8    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
       11    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 typing.py:329(__hash__)
        3    0.000    0.000    0.000    0.000 codecs.py:319(decode)
        9    0.000    0.000    0.000    0.000 states.py:75(evaluating)
        1    0.000    0.000    0.000    0.000 imports.py:25(_package_available)
       11    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
       11    0.000    0.000    0.000    0.000 base.py:54(trainer)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
        4    0.000    0.000    0.000    0.000 inspect.py:2809(<genexpr>)
        2    0.000    0.000    0.000    0.000 {built-in method tensor}
        8    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        3    0.000    0.000    0.000    0.000 enum.py:289(__call__)
        8    0.000    0.000    0.000    0.000 version.py:303(<genexpr>)
        2    0.000    0.000    0.000    0.000 tokenize.py:319(read_or_stop)
        8    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
        8    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        5    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 <string>:1(__new__)
        2    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {built-in method io.open}
        1    0.000    0.000    0.000    0.000 copyreg.py:99(_slotnames)
        2    0.000    0.000    0.000    0.000 tensor.py:906(grad)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:937(_sanity_check)
        2    0.000    0.000    0.000    0.000 copyreg.py:90(__newobj__)
        2    0.000    0.000    0.000    0.000 result.py:395(__init__)
        2    0.000    0.000    0.000    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
        6    0.000    0.000    0.000    0.000 version.py:441(_parse_letter_version)
        1    0.000    0.000    0.000    0.000 version.py:99(__ge__)
        1    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        5    0.000    0.000    0.000    0.000 inspect.py:2527(name)
        2    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 util.py:73(find_spec)
        1    0.000    0.000    0.000    0.000 codecs.py:309(__init__)
        4    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        3    0.000    0.000    0.000    0.000 {method 'match' of 're.Pattern' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
        4    0.000    0.000    0.000    0.000 inspect.py:2539(kind)
        1    0.000    0.000    0.000    0.000 _collections_abc.py:252(__subclasshook__)
        2    0.000    0.000    0.000    0.000 {method 'readline' of '_io.BufferedReader' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        3    0.000    0.000    0.000    0.000 {built-in method _codecs.utf_8_decode}
        2    0.000    0.000    0.000    0.000 {method 'new' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 result.py:178(is_custom_reduction)
        3    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        3    0.000    0.000    0.000    0.000 enum.py:586(__new__)
        1    0.000    0.000    0.000    0.000 inspect.py:513(_is_wrapper)
        3    0.000    0.000    0.000    0.000 version.py:511(<lambda>)
        3    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 functools.py:64(wraps)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        1    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:220(__enter__)
        2    0.000    0.000    0.000    0.000 {method 'decode' of 'bytes' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:228(__exit__)
        2    0.000    0.000    0.000    0.000 storage.py:13(__init__)
        2    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 version.py:482(_parse_local_version)
        2    0.000    0.000    0.000    0.000 inspect.py:2531(default)
        1    0.000    0.000    0.000    0.000 warnings.py:403(__init__)
        1    0.000    0.000    0.000    0.000 result.py:170(is_max_reduction)
        1    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
        1    0.000    0.000    0.000    0.000 _collections_abc.py:72(_check_methods)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C.get_default_dtype}
        1    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'startswith' of 'bytes' objects}
        1    0.000    0.000    0.000    0.000 codecs.py:260(__init__)
        1    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
        1    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
        1    0.000    0.000    0.000    0.000 result.py:142(sync)
        1    0.000    0.000    0.000    0.000 {method 'seek' of '_io.BufferedReader' objects}
        1    0.000    0.000    0.000    0.000 result.py:174(is_min_reduction)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'mappingproxy' objects}
        1    0.000    0.000    0.000    0.000 {method '__setstate__' of 'functools.partial' objects}
        1    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
        1    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 inspect.py:2845(parameters)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}



Profile stats for: validation_step_end
         198 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       11    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       11    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       11    0.000    0.000    0.001    0.000 base.py:68(profile)
       22    0.000    0.000    0.001    0.000 trainer.py:1615(training_type_plugin)
       11    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       33    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       22    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       22    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       11    0.000    0.000    0.000    0.000 lightning.py:879(validation_step_end)
       11    0.000    0.000    0.000    0.000 training_type_plugin.py:230(validation_step_end)
       11    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_batch_end
         12970 function calls in 0.214 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       11    0.002    0.000    0.212    0.019 callback_hook.py:188(on_validation_batch_end)
       11    0.001    0.000    0.203    0.018 tqdm_progress.py:257(on_validation_batch_end)
       22    0.001    0.000    0.199    0.009 tqdm_progress.py:324(_update_bar)
       21    0.001    0.000    0.198    0.009 std.py:1222(update)
       15    0.001    0.000    0.196    0.013 std.py:1360(refresh)
       15    0.001    0.000    0.194    0.013 std.py:1491(display)
       45    0.001    0.000    0.169    0.004 utils.py:325(disp_len)
       45    0.001    0.000    0.167    0.004 utils.py:320(_text_width)
       45    0.042    0.001    0.166    0.004 {built-in method builtins.sum}
     5334    0.083    0.000    0.124    0.000 utils.py:321(<genexpr>)
       15    0.001    0.000    0.118    0.008 std.py:1126(__repr__)
       15    0.004    0.000    0.114    0.008 std.py:343(format_meter)
       15    0.001    0.000    0.073    0.005 std.py:336(print_status)
       15    0.000    0.000    0.069    0.005 utils.py:333(disp_trim)
     5289    0.041    0.000    0.041    0.000 {built-in method unicodedata.east_asian_width}
       55    0.001    0.000    0.007    0.000 trainer.py:1686(lightning_module)
       30    0.003    0.000    0.006    0.000 utils.py:214(_is_ascii)
       55    0.001    0.000    0.005    0.000 accelerator.py:172(lightning_module)
       55    0.001    0.000    0.004    0.000 training_type_plugin.py:171(lightning_module)
      120    0.002    0.000    0.003    0.000 {method 'format' of 'str' objects}
       15    0.001    0.000    0.003    0.000 std.py:1473(format_dict)
       66    0.001    0.000    0.003    0.000 utils.py:141(inner)
       55    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
      315    0.002    0.000    0.002    0.000 {built-in method builtins.ord}
       18    0.001    0.000    0.002    0.000 std.py:1468(moveto)
       15    0.000    0.000    0.002    0.000 std.py:330(fp_write)
       30    0.001    0.000    0.002    0.000 std.py:260(format_interval)
       15    0.001    0.000    0.002    0.000 utils.py:273(_screen_shape_linux)
       11    0.001    0.000    0.002    0.000 enums.py:30(__eq__)
       11    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
      151    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       11    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       33    0.001    0.000    0.001    0.000 {method 'write' of '_io.TextIOWrapper' objects}
       15    0.001    0.000    0.001    0.000 std.py:189(__format__)
       11    0.000    0.000    0.001    0.000 base.py:68(profile)
       15    0.001    0.000    0.001    0.000 {built-in method fcntl.ioctl}
       15    0.001    0.000    0.001    0.000 std.py:104(acquire)
       11    0.000    0.000    0.001    0.000 tqdm_progress.py:321(_should_update)
       11    0.000    0.000    0.001    0.000 advanced.py:66(stop)
       45    0.001    0.000    0.001    0.000 {built-in method time.time}
       15    0.000    0.000    0.001    0.000 std.py:108(release)
       66    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
       22    0.000    0.000    0.001    0.000 types.py:171(__get__)
       75    0.001    0.000    0.001    0.000 {built-in method builtins.divmod}
       15    0.000    0.000    0.000    0.000 std.py:156(__init__)
       45    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
       37    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       41    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       44    0.000    0.000    0.000    0.000 base.py:178(on_validation_batch_end)
       44    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
       33    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
       15    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
       11    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
       15    0.000    0.000    0.000    0.000 {built-in method now}
       34    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       11    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       11    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       30    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       22    0.000    0.000    0.000    0.000 enum.py:689(value)
       22    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       22    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       18    0.000    0.000    0.000    0.000 utils.py:310(_term_move_up)
       15    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
       15    0.000    0.000    0.000    0.000 utils.py:57(__init__)
       15    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
       15    0.000    0.000    0.000    0.000 utils.py:61(__format__)
       15    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
       15    0.000    0.000    0.000    0.000 std.py:166(colour)
       15    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
       11    0.000    0.000    0.000    0.000 base.py:170(on_validation_batch_end)
       15    0.000    0.000    0.000    0.000 std.py:170(colour)
       15    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
       11    0.000    0.000    0.000    0.000 std.py:301(ema)
       11    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 hooks.py:112(on_validation_batch_end)
       11    0.000    0.000    0.000    0.000 base.py:69(val_batch_idx)



Profile stats for: on_validation_epoch_end
         120 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.001    0.001 callback_hook.py:100(on_validation_epoch_end)
       10    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
       10    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:264(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
       12    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:324(_update_bar)
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        8    0.000    0.000    0.000    0.000 base.py:140(on_validation_epoch_end)
        4    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 hooks.py:205(on_validation_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_epoch_end
         165 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        3    0.000    0.000    0.002    0.001 callback_hook.py:130(on_epoch_end)
       15    0.000    0.000    0.002    0.000 trainer.py:1686(lightning_module)
       15    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       15    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       15    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
        3    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       30    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       18    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        3    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       15    0.000    0.000    0.000    0.000 base.py:164(on_epoch_end)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        3    0.000    0.000    0.000    0.000 hooks.py:187(on_epoch_end)
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_validation_end
         2073 function calls (2039 primitive calls) in 0.036 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.036    0.018 callback_hook.py:218(on_validation_end)
        2    0.000    0.000    0.034    0.017 tqdm_progress.py:268(on_validation_end)
        2    0.000    0.000    0.021    0.011 std.py:1429(set_postfix)
        3    0.000    0.000    0.020    0.007 std.py:1491(display)
        2    0.000    0.000    0.019    0.010 std.py:1360(refresh)
        5    0.000    0.000    0.018    0.004 utils.py:325(disp_len)
        5    0.000    0.000    0.018    0.004 utils.py:320(_text_width)
        5    0.004    0.001    0.017    0.003 {built-in method builtins.sum}
        1    0.000    0.000    0.015    0.015 std.py:1126(__repr__)
        1    0.000    0.000    0.014    0.014 std.py:343(format_meter)
      575    0.009    0.000    0.013    0.000 utils.py:321(<genexpr>)
        2    0.000    0.000    0.010    0.005 base.py:185(get_metrics)
        2    0.000    0.000    0.008    0.004 trainer.py:2147(progress_bar_metrics)
        2    0.000    0.000    0.008    0.004 logger_connector.py:349(progress_bar_metrics)
        2    0.000    0.000    0.007    0.004 logger_connector.py:317(metrics)
        1    0.000    0.000    0.007    0.007 utils.py:333(disp_trim)
        2    0.000    0.000    0.006    0.003 result.py:555(metrics)
        3    0.000    0.000    0.005    0.002 std.py:336(print_status)
      570    0.004    0.000    0.004    0.000 {built-in method unicodedata.east_asian_width}
    34/10    0.002    0.000    0.004    0.000 apply_func.py:70(apply_to_collection)
        2    0.000    0.000    0.003    0.001 std.py:1304(close)
        6    0.000    0.000    0.002    0.000 trainer.py:2151(_results)
        6    0.000    0.000    0.002    0.000 trainer.py:2126(_active_loop)
       16    0.001    0.000    0.002    0.000 enums.py:30(__eq__)
      111    0.001    0.000    0.002    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.001    0.001 metrics.py:24(metrics_to_scalars)
        8    0.000    0.000    0.001    0.000 trainer.py:2016(sanity_checking)
        2    0.000    0.000    0.001    0.001 std.py:580(_decr_instances)
       10    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        2    0.000    0.000    0.001    0.000 lightning.py:1791(get_progress_bar_dict)
        6    0.000    0.000    0.001    0.000 trainer.py:1957(training)
        2    0.000    0.000    0.001    0.000 base.py:217(get_standard_metrics)
       16    0.001    0.000    0.001    0.000 result.py:347(meta)
       32    0.001    0.000    0.001    0.000 types.py:171(__get__)
       10    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        8    0.000    0.000    0.001    0.000 metrics.py:32(to_item)
       17    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
        4    0.000    0.000    0.001    0.000 result.py:544(_forked_name)
       10    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       13    0.000    0.000    0.001    0.000 utils.py:141(inner)
        3    0.000    0.000    0.001    0.000 tqdm_progress.py:41(format_num)
        2    0.000    0.000    0.001    0.000 model_checkpoint.py:324(on_validation_end)
        2    0.000    0.000    0.000    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
        9    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
       17    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
       10    0.000    0.000    0.000    0.000 result.py:519(_get_cache)
        2    0.000    0.000    0.000    0.000 utils.py:214(_is_ascii)
        6    0.000    0.000    0.000    0.000 result.py:538(<genexpr>)
        3    0.000    0.000    0.000    0.000 std.py:330(fp_write)
        4    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        3    0.000    0.000    0.000    0.000 std.py:282(format_num)
        3    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
       32    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        2    0.000    0.000    0.000    0.000 supporters.py:93(mean)
        4    0.000    0.000    0.000    0.000 std.py:112(__enter__)
       32    0.000    0.000    0.000    0.000 enum.py:689(value)
        1    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
       24    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        4    0.000    0.000    0.000    0.000 std.py:115(__exit__)
      6/1    0.000    0.000    0.000    0.000 abc.py:100(__subclasscheck__)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        5    0.000    0.000    0.000    0.000 std.py:108(release)
      6/1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
       11    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 std.py:1468(moveto)
        9    0.000    0.000    0.000    0.000 std.py:1455(<genexpr>)
       10    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 supporters.py:105(_agg_memory)
        3    0.000    0.000    0.000    0.000 std.py:1321(fp_write)
        1    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        4    0.000    0.000    0.000    0.000 std.py:1129(_comparable)
        8    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 trainer.py:2116(_evaluation_loop)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
       14    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       16    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
       16    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        6    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 std.py:260(format_interval)
        5    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        4    0.000    0.000    0.000    0.000 result.py:157(forked_name)
        4    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 result.py:570(any_tensor)
       10    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        3    0.000    0.000    0.000    0.000 trainer.py:2012(evaluating)
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        9    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        8    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        7    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 std.py:156(__init__)
        1    0.000    0.000    0.000    0.000 std.py:189(__format__)
        2    0.000    0.000    0.000    0.000 result.py:536(valid_items)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        7    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 std.py:1133(__hash__)
        6    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        5    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 fit_loop.py:123(running_loss)
        1    0.000    0.000    0.000    0.000 trainer.py:2031(global_step)
        5    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        4    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        4    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 result.py:153(forked)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        4    0.000    0.000    0.000    0.000 base.py:250(on_validation_end)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 states.py:75(evaluating)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        1    0.000    0.000    0.000    0.000 std.py:602(<lambda>)
        2    0.000    0.000    0.000    0.000 typing_extensions.py:1603(_dict_new)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        2    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        2    0.000    0.000    0.000    0.000 early_stopping.py:191(on_validation_end)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        2    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 hooks.py:49(on_validation_end)
        2    0.000    0.000    0.000    0.000 training_type_plugin.py:351(on_validation_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 utils.py:310(_term_move_up)
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 lightning.py:256(automatic_optimization)
        1    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 std.py:170(colour)
        1    0.000    0.000    0.000    0.000 std.py:166(colour)



Profile stats for: on_sanity_check_end
         58 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:80(on_sanity_check_end)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:213(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 module.py:934(__getattr__)
        4    0.000    0.000    0.000    0.000 base.py:95(on_sanity_check_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 std.py:1304(close)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:620(on_train_dataloader)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)



Profile stats for: on_train_start
         219 function calls in 0.009 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.005    0.005 callback_hook.py:135(on_train_start)
        1    0.000    0.000    0.004    0.004 gpu.py:48(on_train_start)
        1    0.000    0.000    0.004    0.004 memory.py:102(empty_cache)
        1    0.004    0.004    0.004    0.004 {built-in method torch._C._cuda_emptyCache}
        1    0.000    0.000    0.004    0.004 tqdm_progress.py:217(on_train_start)
        1    0.000    0.000    0.004    0.004 tqdm_progress.py:155(init_train_tqdm)
        1    0.000    0.000    0.003    0.003 tqdm_progress.py:35(__init__)
        1    0.000    0.000    0.003    0.003 std.py:828(__init__)
        1    0.000    0.000    0.002    0.002 std.py:1360(refresh)
        1    0.000    0.000    0.002    0.002 std.py:1491(display)
        1    0.000    0.000    0.001    0.001 std.py:336(print_status)
        1    0.000    0.000    0.001    0.001 utils.py:325(disp_len)
        1    0.000    0.000    0.001    0.001 utils.py:320(_text_width)
        1    0.000    0.000    0.001    0.001 {built-in method builtins.sum}
       29    0.001    0.000    0.001    0.000 utils.py:321(<genexpr>)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 std.py:1126(__repr__)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 std.py:557(__new__)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 std.py:343(format_meter)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       28    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        2    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 utils.py:154(__init__)
        3    0.000    0.000    0.000    0.000 std.py:108(release)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        3    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        1    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        1    0.000    0.000    0.000    0.000 std.py:330(fp_write)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 utils.py:207(_supports_unicode)
        2    0.000    0.000    0.000    0.000 utils.py:141(inner)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 std.py:260(format_interval)
        3    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        7    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 utils.py:163(__eq__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:133(is_disabled)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:277(on_train_start)
        3    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        1    0.000    0.000    0.000    0.000 __init__.py:107(is_initialized)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 utils.py:193(_is_utf)
        1    0.000    0.000    0.000    0.000 std.py:320(status_printer)
        1    0.000    0.000    0.000    0.000 accelerator.py:571(on_train_start)
        1    0.000    0.000    0.000    0.000 std.py:1123(__del__)
        1    0.000    0.000    0.000    0.000 _monitor.py:92(report)
        1    0.000    0.000    0.000    0.000 std.py:654(get_lock)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 std.py:1133(__hash__)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        3    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 base.py:230(on_train_start)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        1    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 utils.py:223(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        1    0.000    0.000    0.000    0.000 base.py:158(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        1    0.000    0.000    0.000    0.000 std.py:1304(close)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:125(process_position)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:331(on_train_start)
        1    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        1    0.000    0.000    0.000    0.000 hooks.py:40(on_train_start)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)



Profile stats for: run_training_epoch
         43 function calls in 18.811 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   18.811   18.811 base.py:109(run)
        1    0.000    0.000   18.810   18.810 training_epoch_loop.py:133(on_run_start)
        1    0.000    0.000   18.810   18.810 trainer.py:1481(call_hook)
        1    0.000    0.000   18.810   18.810 contextlib.py:108(__enter__)
        1    0.000    0.000   18.810   18.810 {built-in method builtins.next}
        1    0.000    0.000   18.810   18.810 base.py:68(profile)
        1    0.000    0.000   18.810   18.810 advanced.py:61(start)
        1   18.810   18.810   18.810   18.810 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:118(reset)
        4    0.000    0.000    0.000    0.000 progress.py:154(reset_on_run)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 progress.py:263(reset_on_run)
        1    0.000    0.000    0.000    0.000 progress.py:194(reset_on_run)
        1    0.000    0.000    0.000    0.000 module.py:950(__setattr__)
        1    0.000    0.000    0.000    0.000 progress.py:230(reset_on_run)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 progress.py:101(reset)
        2    0.000    0.000    0.000    0.000 progress.py:77(reset)
        1    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        4    0.000    0.000    0.000    0.000 progress.py:49(reset)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 base.py:54(trainer)
        1    0.000    0.000    0.000    0.000 logger_connector.py:258(on_epoch_start)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 base.py:84(skip)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)



Profile stats for: on_train_epoch_start
         1596 function calls in 0.029 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.029    0.029 callback_hook.py:85(on_train_epoch_start)
        1    0.000    0.000    0.028    0.028 tqdm_progress.py:221(on_train_epoch_start)
        2    0.000    0.000    0.027    0.013 std.py:1360(refresh)
        2    0.000    0.000    0.027    0.013 std.py:1491(display)
        6    0.000    0.000    0.024    0.004 utils.py:325(disp_len)
        6    0.000    0.000    0.024    0.004 utils.py:320(_text_width)
        7    0.006    0.001    0.023    0.003 {built-in method builtins.sum}
      669    0.012    0.000    0.018    0.000 utils.py:321(<genexpr>)
        2    0.000    0.000    0.016    0.008 std.py:1126(__repr__)
        2    0.000    0.000    0.015    0.008 std.py:343(format_meter)
        1    0.000    0.000    0.014    0.014 tqdm_progress.py:347(reset)
        1    0.000    0.000    0.014    0.014 std.py:1393(reset)
        1    0.000    0.000    0.013    0.013 std.py:1409(set_description)
        2    0.000    0.000    0.011    0.005 std.py:336(print_status)
        2    0.000    0.000    0.011    0.005 utils.py:333(disp_trim)
      663    0.006    0.000    0.006    0.000 {built-in method unicodedata.east_asian_width}
        4    0.000    0.000    0.001    0.000 utils.py:214(_is_ascii)
        6    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        6    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
        2    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
       10    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 std.py:330(fp_write)
        1    0.000    0.000    0.000    0.000 trainer.py:1842(enable_validation)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        4    0.000    0.000    0.000    0.000 utils.py:141(inner)
       19    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        3    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
        2    0.000    0.000    0.000    0.000 std.py:189(__format__)
        2    0.000    0.000    0.000    0.000 std.py:260(format_interval)
        1    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:102(on_train_epoch_start)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        7    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 std.py:156(__init__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:337(convert_inf)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        4    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        5    0.000    0.000    0.000    0.000 base.py:57(trainer)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 base.py:93(total_train_batches)
        1    0.000    0.000    0.000    0.000 base.py:161(on_train_epoch_start)
        3    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        3    0.000    0.000    0.000    0.000 base.py:122(on_train_epoch_start)
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 hooks.py:190(on_train_epoch_start)
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        2    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 std.py:170(colour)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 std.py:166(colour)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:94(get_accumulate_grad_batches)
        1    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        1    0.000    0.000    0.000    0.000 {built-in method math.isnan}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: get_train_batch
         210 function calls (190 primitive calls) in 0.175 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    30/20    0.000    0.000    0.174    0.009 contextlib.py:108(__enter__)
    30/20    0.001    0.000    0.174    0.009 {built-in method builtins.next}
       10    0.000    0.000    0.173    0.017 fetching.py:287(apply_profiler)
       10    0.000    0.000    0.172    0.017 base.py:68(profile)
       10    0.000    0.000    0.172    0.017 advanced.py:61(start)
       10    0.172    0.017    0.172    0.017 {method 'enable' of '_lsprof.Profiler' objects}
       30    0.001    0.000    0.001    0.000 contextlib.py:238(helper)
       30    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
       30    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)
       10    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_train_batch
         1044 function calls (1002 primitive calls) in 0.171 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    50/19    0.001    0.000    0.171    0.009 {built-in method builtins.next}
       10    0.000    0.000    0.170    0.017 supporters.py:544(__next__)
       10    0.000    0.000    0.169    0.017 supporters.py:552(request_next_batch)
       10    0.000    0.000    0.169    0.017 apply_func.py:70(apply_to_collection)
       10    0.001    0.000    0.168    0.017 dataloader.py:513(__next__)
       10    0.001    0.000    0.165    0.016 dataloader.py:1152(_next_data)
        9    0.000    0.000    0.091    0.010 dataloader.py:1119(_get_data)
        9    0.000    0.000    0.090    0.010 dataloader.py:973(_try_get_data)
        9    0.001    0.000    0.090    0.010 queue.py:153(get)
        5    0.001    0.000    0.087    0.017 threading.py:270(wait)
       51    0.087    0.002    0.087    0.002 {method 'acquire' of '_thread.lock' objects}
        1    0.001    0.001    0.071    0.071 dataloader.py:1254(_shutdown_workers)
        4    0.000    0.000    0.061    0.015 process.py:142(join)
        4    0.000    0.000    0.061    0.015 popen_fork.py:40(wait)
        4    0.001    0.000    0.060    0.015 connection.py:917(wait)
        4    0.000    0.000    0.058    0.014 selectors.py:402(select)
        4    0.056    0.014    0.057    0.014 {method 'poll' of 'select.poll' objects}
        5    0.000    0.000    0.003    0.001 queues.py:134(close)
        6    0.000    0.000    0.003    0.000 queues.py:80(put)
        5    0.000    0.000    0.003    0.001 util.py:205(__call__)
        5    0.001    0.000    0.002    0.000 queues.py:200(_finalize_close)
       21    0.001    0.000    0.002    0.000 threading.py:341(notify)
    20/10    0.000    0.000    0.002    0.000 contextlib.py:117(__exit__)
        9    0.000    0.000    0.002    0.000 dataloader.py:1221(_process_data)
        4    0.000    0.000    0.002    0.000 dataloader.py:1228(_mark_worker_as_unavailable)
        1    0.000    0.000    0.001    0.001 queues.py:158(_start_thread)
        9    0.000    0.000    0.001    0.000 dataloader.py:1201(_try_put_index)
       10    0.000    0.000    0.001    0.000 fetching.py:287(apply_profiler)
       10    0.000    0.000    0.001    0.000 threading.py:1017(_wait_for_tstate_lock)
       10    0.000    0.000    0.001    0.000 profiler.py:615(__enter__)
        1    0.000    0.000    0.001    0.001 threading.py:979(join)
        1    0.000    0.000    0.001    0.001 threading.py:834(start)
       26    0.001    0.000    0.001    0.000 threading.py:261(_is_owned)
        8    0.000    0.000    0.001    0.000 popen_fork.py:24(poll)
       22    0.001    0.000    0.001    0.000 threading.py:246(__enter__)
        4    0.000    0.000    0.001    0.000 selectors.py:351(register)
       25    0.000    0.000    0.001    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.001    0.000 profiler.py:619(__exit__)
       22    0.000    0.000    0.001    0.000 threading.py:249(__exit__)
       10    0.000    0.000    0.001    0.000 profiler.py:607(__init__)
        1    0.000    0.000    0.001    0.001 threading.py:540(wait)
       10    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter}
        9    0.000    0.000    0.001    0.000 threading.py:1071(is_alive)
        9    0.000    0.000    0.001    0.000 dataloader.py:507(_next_index)
       10    0.000    0.000    0.001    0.000 base.py:68(profile)
        4    0.000    0.000    0.001    0.000 synchronize.py:327(is_set)
        4    0.000    0.000    0.001    0.000 selectors.py:234(register)
        5    0.000    0.000    0.001    0.000 connection.py:173(close)
        4    0.000    0.000    0.001    0.000 signal_handling.py:63(handler)
       46    0.001    0.000    0.001    0.000 {built-in method builtins.len}
       13    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
       17    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
       10    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_exit}
       10    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       10    0.000    0.000    0.000    0.000 {built-in method zeros}
        4    0.000    0.000    0.000    0.000 selectors.py:347(__init__)
        5    0.000    0.000    0.000    0.000 connection.py:360(_close)
        9    0.000    0.000    0.000    0.000 queue.py:216(_get)
       16    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        5    0.000    0.000    0.000    0.000 threading.py:258(_acquire_restore)
        1    0.000    0.000    0.000    0.000 synchronize.py:334(set)
        2    0.000    0.000    0.000    0.000 sampler.py:225(__iter__)
        4    0.000    0.000    0.000    0.000 process.py:153(is_alive)
        4    0.000    0.000    0.000    0.000 selectors.py:202(__exit__)
        5    0.000    0.000    0.000    0.000 queues.py:150(cancel_join_thread)
       10    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       22    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._error_if_any_worker_fails}
       22    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        4    0.000    0.000    0.000    0.000 selectors.py:215(_fileobj_lookup)
        5    0.000    0.000    0.000    0.000 synchronize.py:229(__enter__)
        1    0.000    0.000    0.000    0.000 threading.py:761(__init__)
        5    0.000    0.000    0.000    0.000 synchronize.py:232(__exit__)
        4    0.000    0.000    0.000    0.000 selectors.py:268(close)
       15    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 threading.py:519(set)
       16    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        4    0.000    0.000    0.000    0.000 {built-in method posix.waitpid}
       13    0.000    0.000    0.000    0.000 util.py:48(debug)
        1    0.000    0.000    0.000    0.000 {built-in method _thread.start_new_thread}
        5    0.000    0.000    0.000    0.000 {built-in method posix.close}
        5    0.000    0.000    0.000    0.000 threading.py:255(_release_save)
       14    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        9    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 abc.py:100(__subclasscheck__)
        4    0.000    0.000    0.000    0.000 <string>:1(__new__)
        4    0.000    0.000    0.000    0.000 selectors.py:209(__init__)
        1    0.000    0.000    0.000    0.000 synchronize.py:296(notify_all)
        4    0.000    0.000    0.000    0.000 selectors.py:21(_fileobj_to_fd)
        5    0.000    0.000    0.000    0.000 synchronize.py:94(__enter__)
      2/1    0.000    0.000    0.000    0.000 {method 'throw' of 'generator' objects}
        2    0.000    0.000    0.000    0.000 util.py:186(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
        5    0.000    0.000    0.000    0.000 synchronize.py:97(__exit__)
        1    0.000    0.000    0.000    0.000 synchronize.py:270(notify)
       10    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
       12    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        6    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        8    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}
        1    0.000    0.000    0.000    0.000 threading.py:364(notify_all)
       10    0.000    0.000    0.000    0.000 supporters.py:533(loader_iters)
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 util.py:44(sub_debug)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        8    0.000    0.000    0.000    0.000 process.py:99(_check_closed)
        4    0.000    0.000    0.000    0.000 {built-in method posix.WIFSIGNALED}
        6    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        4    0.000    0.000    0.000    0.000 selectors.py:275(_key_from_fd)
        2    0.000    0.000    0.000    0.000 threading.py:1306(current_thread)
        1    0.000    0.000    0.000    0.000 threading.py:944(_stop)
        4    0.000    0.000    0.000    0.000 connection.py:933(<listcomp>)
        1    0.000    0.000    0.000    0.000 _collections_abc.py:271(__subclasshook__)
        4    0.000    0.000    0.000    0.000 {built-in method math.ceil}
        4    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 threading.py:505(__init__)
        3    0.000    0.000    0.000    0.000 sampler.py:113(__iter__)
        4    0.000    0.000    0.000    0.000 {built-in method posix.WIFEXITED}
        4    0.000    0.000    0.000    0.000 {built-in method posix.WEXITSTATUS}
        4    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        5    0.000    0.000    0.000    0.000 {method '__enter__' of '_multiprocessing.SemLock' objects}
        4    0.000    0.000    0.000    0.000 {method 'register' of 'select.poll' objects}
        4    0.000    0.000    0.000    0.000 selectors.py:63(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method select.poll}
        4    0.000    0.000    0.000    0.000 selectors.py:199(__enter__)
        5    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {method '__exit__' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        1    0.000    0.000    0.000    0.000 threading.py:1110(daemon)
        2    0.000    0.000    0.000    0.000 threading.py:1095(daemon)
        2    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 threading.py:222(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._remove_worker_pids}
        1    0.000    0.000    0.000    0.000 _collections_abc.py:72(_check_methods)
        1    0.000    0.000    0.000    0.000 util.py:229(cancel)
        1    0.000    0.000    0.000    0.000 threading.py:1177(_make_invoke_excepthook)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method '_is_mine' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'clear' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'locked' of '_thread.lock' objects}



Profile stats for: training_batch_to_device
         15184 function calls (14393 primitive calls) in 0.251 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.250    0.028 accelerator.py:192(batch_to_device)
        9    0.001    0.000    0.248    0.028 lightning.py:284(_apply_batch_transfer_handler)
        9    0.000    0.000    0.234    0.026 hooks.py:652(transfer_batch_to_device)
        9    0.000    0.000    0.233    0.026 apply_func.py:245(move_data_to_device)
    791/9    0.056    0.000    0.233    0.026 apply_func.py:70(apply_to_collection)
     4248    0.051    0.000    0.131    0.000 {built-in method builtins.isinstance}
     2186    0.035    0.000    0.080    0.000 abc.py:96(__instancecheck__)
     2186    0.022    0.000    0.045    0.000 {built-in method _abc._abc_instancecheck}
      568    0.009    0.000    0.032    0.000 apply_func.py:65(_is_dataclass_instance)
      568    0.009    0.000    0.023    0.000 abc.py:100(__subclasscheck__)
      568    0.013    0.000    0.023    0.000 dataclasses.py:1045(is_dataclass)
      604    0.010    0.000    0.015    0.000 apply_func.py:60(_is_namedtuple)
      568    0.009    0.000    0.014    0.000 {built-in method _abc._abc_subclasscheck}
        9    0.000    0.000    0.013    0.001 signature_utils.py:18(is_param_in_hook_signature)
        9    0.000    0.000    0.013    0.001 inspect.py:3091(signature)
        9    0.000    0.000    0.013    0.001 inspect.py:2839(from_callable)
     18/9    0.001    0.000    0.012    0.001 inspect.py:2206(_signature_from_callable)
        9    0.002    0.000    0.007    0.001 inspect.py:2112(_signature_from_function)
      818    0.006    0.000    0.006    0.000 {method 'append' of 'list' objects}
      577    0.005    0.000    0.005    0.000 {built-in method builtins.hasattr}
      568    0.005    0.000    0.005    0.000 _collections_abc.py:302(__subclasshook__)
       18    0.001    0.000    0.003    0.000 inspect.py:2760(__init__)
       36    0.001    0.000    0.003    0.000 inspect.py:2477(__init__)
        9    0.001    0.000    0.003    0.000 inspect.py:1800(_signature_bound_method)
        9    0.000    0.000    0.002    0.000 apply_func.py:262(batch_to)
        9    0.002    0.000    0.002    0.000 {method 'to' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.002    0.000 inspect.py:2853(replace)
      178    0.002    0.000    0.002    0.000 {method 'items' of 'dict' objects}
       45    0.001    0.000    0.001    0.000 inspect.py:2809(<genexpr>)
       36    0.001    0.000    0.001    0.000 enum.py:289(__call__)
        9    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
        9    0.000    0.000    0.001    0.000 inspect.py:493(unwrap)
        9    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       63    0.001    0.000    0.001    0.000 inspect.py:2527(name)
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
        9    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       18    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
       54    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       45    0.000    0.000    0.000    0.000 inspect.py:2539(kind)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        9    0.000    0.000    0.000    0.000 accelerator.py:180(root_device)
       36    0.000    0.000    0.000    0.000 enum.py:586(__new__)
       36    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
        9    0.000    0.000    0.000    0.000 inspect.py:513(_is_wrapper)
       27    0.000    0.000    0.000    0.000 inspect.py:2531(default)
       18    0.000    0.000    0.000    0.000 inspect.py:2845(parameters)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
        9    0.000    0.000    0.000    0.000 single_device.py:63(root_device)
        9    0.000    0.000    0.000    0.000 base.py:54(trainer)
        9    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)
        9    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 hooks.py:744(on_after_batch_transfer)



Profile stats for: on_batch_start
         504 function calls in 0.008 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.006    0.001 callback_hook.py:155(on_batch_start)
       45    0.001    0.000    0.005    0.000 trainer.py:1686(lightning_module)
       45    0.001    0.000    0.003    0.000 accelerator.py:172(lightning_module)
       45    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       18    0.000    0.000    0.001    0.000 {built-in method builtins.getattr}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        9    0.000    0.000    0.000    0.000 base.py:68(profile)
       54    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       45    0.000    0.000    0.000    0.000 base.py:168(on_batch_start)
        9    0.000    0.000    0.000    0.000 module.py:934(__getattr__)
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_train_batch_start
         5166 function calls (5121 primitive calls) in 0.087 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.085    0.009 callback_hook.py:166(on_train_batch_start)
       45    0.002    0.000    0.079    0.002 signature_utils.py:18(is_param_in_hook_signature)
       45    0.001    0.000    0.076    0.002 inspect.py:3091(signature)
       45    0.001    0.000    0.076    0.002 inspect.py:2839(from_callable)
    90/45    0.006    0.000    0.075    0.002 inspect.py:2206(_signature_from_callable)
       45    0.011    0.000    0.047    0.001 inspect.py:2112(_signature_from_function)
       90    0.009    0.000    0.022    0.000 inspect.py:2760(__init__)
      270    0.009    0.000    0.020    0.000 inspect.py:2477(__init__)
       45    0.002    0.000    0.016    0.000 inspect.py:1800(_signature_bound_method)
       45    0.001    0.000    0.012    0.000 inspect.py:2853(replace)
      315    0.005    0.000    0.007    0.000 inspect.py:2809(<genexpr>)
      270    0.004    0.000    0.006    0.000 enum.py:289(__call__)
      630    0.005    0.000    0.005    0.000 {built-in method builtins.isinstance}
       45    0.001    0.000    0.005    0.000 trainer.py:1686(lightning_module)
      495    0.004    0.000    0.004    0.000 inspect.py:2527(name)
       45    0.002    0.000    0.003    0.000 inspect.py:493(unwrap)
       45    0.001    0.000    0.003    0.000 accelerator.py:172(lightning_module)
      324    0.003    0.000    0.003    0.000 {method 'get' of 'dict' objects}
       45    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
      315    0.003    0.000    0.003    0.000 inspect.py:2539(kind)
      270    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}
      270    0.002    0.000    0.002    0.000 {method 'isidentifier' of 'str' objects}
       90    0.001    0.000    0.002    0.000 inspect.py:158(isfunction)
      270    0.002    0.000    0.002    0.000 enum.py:586(__new__)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
      225    0.002    0.000    0.002    0.000 inspect.py:2531(default)
       45    0.001    0.000    0.001    0.000 inspect.py:513(_is_wrapper)
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
      108    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       90    0.001    0.000    0.001    0.000 inspect.py:2845(parameters)
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       72    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
       63    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
       54    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       18    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       45    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       45    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       45    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       45    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       45    0.000    0.000    0.000    0.000 base.py:99(on_train_batch_start)
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:363(on_train_batch_start)
        9    0.000    0.000    0.000    0.000 hooks.py:82(on_train_batch_start)



Profile stats for: run_training_batch
         1220 function calls (1211 primitive calls) in 10.853 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     18/9    0.001    0.000   10.853    1.206 base.py:109(run)
        9    0.001    0.000   10.850    1.206 training_batch_loop.py:72(advance)
        9    0.000    0.000   10.845    1.205 optimizer_loop.py:214(advance)
        9    0.001    0.000   10.844    1.205 optimizer_loop.py:231(_run_optimization)
        9    0.001    0.000   10.839    1.204 optimizer_loop.py:353(_optimizer_step)
        9    0.000    0.000   10.832    1.204 lightning.py:1571(optimizer_step)
        9    0.000    0.000   10.831    1.203 optimizer.py:95(step)
        9    0.000    0.000   10.831    1.203 contextlib.py:108(__enter__)
        9    0.000    0.000   10.830    1.203 {built-in method builtins.next}
        9    0.000    0.000   10.830    1.203 base.py:68(profile)
        9    0.000    0.000   10.830    1.203 advanced.py:61(start)
        9   10.830    1.203   10.830    1.203 {method 'enable' of '_lsprof.Profiler' objects}
       27    0.001    0.000    0.003    0.000 trainer.py:1686(lightning_module)
       27    0.000    0.000    0.002    0.000 accelerator.py:172(lightning_module)
        9    0.001    0.000    0.002    0.000 optimizer_loop.py:283(_make_closure)
        9    0.000    0.000    0.002    0.000 training_batch_loop.py:62(on_run_start)
        9    0.000    0.000    0.002    0.000 optimizer.py:63(_to_lightning_optimizer)
       18    0.000    0.000    0.002    0.000 trainer.py:1719(amp_backend)
       27    0.000    0.000    0.002    0.000 training_type_plugin.py:171(lightning_module)
        9    0.000    0.000    0.001    0.000 fit_loop.py:265(_should_accumulate)
        9    0.000    0.000    0.001    0.000 training_batch_loop.py:108(_tbptt_split_batch)
      162    0.001    0.000    0.001    0.000 base.py:54(trainer)
        9    0.000    0.000    0.001    0.000 training_epoch_loop.py:356(_should_accumulate)
        9    0.000    0.000    0.001    0.000 enums.py:30(__eq__)
       27    0.001    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
       18    0.001    0.000    0.001    0.000 accelerator.py:372(amp_backend)
      109    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       92    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.001    0.000 trainer.py:1796(lightning_optimizers)
        9    0.000    0.000    0.001    0.000 optimizer_loop.py:335(_run_optimization_start)
        1    0.000    0.000    0.001    0.001 optimizers.py:112(convert_to_lightning_optimizers)
       20    0.000    0.000    0.001    0.000 trainer.py:1690(optimizers)
        1    0.000    0.000    0.000    0.000 optimizers.py:119(<dictcomp>)
       18    0.000    0.000    0.000    0.000 types.py:171(__get__)
        1    0.000    0.000    0.000    0.000 optimizers.py:113(_convert_to_lightning_optimizer)
       18    0.000    0.000    0.000    0.000 base.py:174(on_advance_start)
       18    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        9    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
       18    0.000    0.000    0.000    0.000 optimizer_loop.py:190(done)
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:206(on_run_start)
        9    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:127(__init__)
       36    0.000    0.000    0.000    0.000 utils.py:51(void)
        9    0.000    0.000    0.000    0.000 typing.py:868(__new__)
       36    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
        9    0.000    0.000    0.000    0.000 training_epoch_loop.py:343(_num_ready_batches_reached)
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
        9    0.000    0.000    0.000    0.000 trainer.py:1711(optimizer_frequencies)
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:298(_make_zero_grad_fn)
        9    0.000    0.000    0.000    0.000 training_epoch_loop.py:339(_accumulated_batches_reached)
        9    0.000    0.000    0.000    0.000 training_batch_loop.py:45(done)
       18    0.000    0.000    0.000    0.000 enum.py:689(value)
       18    0.000    0.000    0.000    0.000 base.py:84(skip)
        9    0.000    0.000    0.000    0.000 closure.py:60(__init__)
       18    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       18    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
       18    0.000    0.000    0.000    0.000 training_type_plugin.py:276(handles_gradient_accumulation)
        1    0.000    0.000    0.000    0.000 optimizer.py:56(_on_trainer_init)
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:317(_make_backward_fn)
        9    0.000    0.000    0.000    0.000 progress.py:126(increment_ready)
        9    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        9    0.000    0.000    0.000    0.000 trainer.py:1650(_device_type)
        9    0.000    0.000    0.000    0.000 training_batch_loop.py:58(reset)
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:198(reset)
        9    0.000    0.000    0.000    0.000 utilities.py:151(_get_active_optimizers)
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:294(_make_step_fn)
        9    0.000    0.000    0.000    0.000 logger_connector.py:214(on_train_split_start)
        9    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
        9    0.000    0.000    0.000    0.000 {method 'pop' of 'list' objects}
        9    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        9    0.000    0.000    0.000    0.000 optimizer_loop.py:186(optimizer_idx)
        9    0.000    0.000    0.000    0.000 lightning.py:256(automatic_optimization)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 optimizer.py:36(<dictcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: optimizer_step_with_closure_0
         342 function calls in 10.805 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.000    0.000   10.805    1.201 accelerator.py:321(optimizer_step)
        9    0.000    0.000   10.804    1.200 precision_plugin.py:152(optimizer_step)
        9    0.001    0.000   10.803    1.200 optimizer.py:84(wrapper)
        9    0.000    0.000   10.801    1.200 grad_mode.py:24(decorate_context)
        9    0.000    0.000   10.800    1.200 adam.py:55(step)
        9    0.000    0.000   10.799    1.200 precision_plugin.py:135(_wrap_closure)
        9    0.000    0.000   10.799    1.200 optimizer_loop.py:159(__call__)
        9    0.000    0.000   10.799    1.200 optimizer_loop.py:140(closure)
        9    0.000    0.000   10.798    1.200 contextlib.py:108(__enter__)
        9    0.000    0.000   10.798    1.200 {built-in method builtins.next}
        9    0.000    0.000   10.798    1.200 base.py:68(profile)
        9    0.000    0.000   10.798    1.200 advanced.py:61(start)
        9   10.798    1.200   10.798    1.200 {method 'enable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.001    0.000 grad_mode.py:119(__enter__)
        9    0.000    0.000    0.001    0.000 profiler.py:615(__enter__)
        9    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        9    0.000    0.000    0.001    0.000 profiler.py:607(__init__)
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        9    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_enter}
        9    0.000    0.000    0.000    0.000 {built-in method zeros}
        9    0.000    0.000    0.000    0.000 grad_mode.py:200(__init__)
        9    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        9    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.000    0.000 grad_mode.py:158(__enter__)
        9    0.000    0.000    0.000    0.000 grad_mode.py:114(__init__)
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
       27    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
       27    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       18    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        9    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        9    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 _jit_internal.py:833(is_scripting)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: training_step_and_backward
         162 function calls in 10.615 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.000    0.000   10.615    1.179 optimizer_loop.py:412(_training_step)
        9    0.000    0.000   10.614    1.179 contextlib.py:108(__enter__)
        9    0.000    0.000   10.613    1.179 {built-in method builtins.next}
        9    0.000    0.000   10.613    1.179 base.py:68(profile)
        9    0.000    0.000   10.613    1.179 advanced.py:61(start)
        9   10.613    1.179   10.613    1.179 {method 'enable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        9    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        9    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        9    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
       18    0.000    0.000    0.000    0.000 base.py:54(trainer)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: model_forward
         783 function calls (774 primitive calls) in 3.493 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.000    0.000    3.480    0.387 contextlib.py:108(__enter__)
        9    0.000    0.000    3.480    0.387 {built-in method builtins.next}
        9    0.000    0.000    3.480    0.387 base.py:68(profile)
        9    0.000    0.000    3.480    0.387 advanced.py:61(start)
        9    3.480    0.387    3.480    0.387 {method 'enable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.011    0.001 utilities.py:65(_build_training_step_kwargs)
        9    0.000    0.000    0.010    0.001 signature_utils.py:18(is_param_in_hook_signature)
        9    0.000    0.000    0.010    0.001 inspect.py:3091(signature)
        9    0.000    0.000    0.010    0.001 inspect.py:2839(from_callable)
     18/9    0.001    0.000    0.009    0.001 inspect.py:2206(_signature_from_callable)
        9    0.001    0.000    0.005    0.001 inspect.py:2112(_signature_from_function)
       18    0.001    0.000    0.002    0.000 inspect.py:2760(__init__)
       27    0.001    0.000    0.002    0.000 inspect.py:2477(__init__)
        9    0.001    0.000    0.002    0.000 inspect.py:1800(_signature_bound_method)
        9    0.000    0.000    0.001    0.000 inspect.py:2853(replace)
        9    0.001    0.000    0.001    0.000 module.py:950(__setattr__)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       36    0.000    0.000    0.001    0.000 inspect.py:2809(<genexpr>)
        9    0.000    0.000    0.001    0.000 inspect.py:493(unwrap)
       27    0.000    0.000    0.001    0.000 enum.py:289(__call__)
       63    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
       18    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
        9    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
       45    0.000    0.000    0.000    0.000 inspect.py:2527(name)
       36    0.000    0.000    0.000    0.000 inspect.py:2539(kind)
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
       27    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       27    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       27    0.000    0.000    0.000    0.000 enum.py:586(__new__)
        9    0.000    0.000    0.000    0.000 inspect.py:513(_is_wrapper)
       27    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        9    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
       18    0.000    0.000    0.000    0.000 base.py:54(trainer)
       18    0.000    0.000    0.000    0.000 inspect.py:2531(default)
       18    0.000    0.000    0.000    0.000 inspect.py:2845(parameters)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
        9    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
        9    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        9    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.id}



Profile stats for: training_step
         150228 function calls (143687 primitive calls) in 3.471 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    3.471    0.386 accelerator.py:213(training_step)
        9    0.002    0.000    3.467    0.385 training_type_plugin.py:212(training_step)
        9    0.002    0.000    3.466    0.385 selfexplainer.py:69(training_step)
  5850/45    0.589    0.000    3.301    0.073 module.py:866(_call_impl)
        9    0.002    0.000    3.029    0.337 selfexplainer.py:50(forward)
       27    0.002    0.000    3.026    0.112 selfexplainer.py:60(_forward)
       27    0.001    0.000    2.780    0.103 DeepLabv3.py:10(forward)
       27    0.002    0.000    2.773    0.103 _utils.py:16(forward)
  378/135    0.021    0.000    2.675    0.020 container.py:117(forward)
       27    0.004    0.000    2.378    0.088 _utils.py:60(forward)
      432    0.102    0.000    2.210    0.005 resnet.py:121(forward)
     1620    0.300    0.000    1.081    0.001 batchnorm.py:99(forward)
     1620    0.093    0.000    0.376    0.000 functional.py:2117(batch_norm)
       27    0.005    0.000    0.309    0.011 deeplabv3.py:88(forward)
     1647    0.060    0.000    0.306    0.000 conv.py:398(forward)
     2610    0.165    0.000    0.287    0.000 module.py:950(__setattr__)
        9    0.002    0.000    0.252    0.028 metric.py:191(forward)
    23904    0.219    0.000    0.219    0.000 module.py:934(__getattr__)
     1647    0.033    0.000    0.217    0.000 conv.py:390(_conv_forward)
    25114    0.204    0.000    0.204    0.000 {built-in method builtins.len}
       36    0.002    0.000    0.201    0.006 metric.py:259(wrapped_func)
    23841    0.194    0.000    0.194    0.000 {method 'values' of 'collections.OrderedDict' objects}
       27    0.115    0.004    0.192    0.007 weighting.py:3(softmax_weighting)
       18    0.101    0.006    0.191    0.011 metrics.py:49(update)
     1647    0.183    0.000    0.183    0.000 {built-in method conv2d}
     1620    0.162    0.000    0.162    0.000 {built-in method batch_norm}
       18    0.003    0.000    0.154    0.009 lightning.py:324(log)
     1512    0.028    0.000    0.143    0.000 activation.py:101(forward)
11735/11654    0.102    0.000    0.123    0.000 {built-in method builtins.isinstance}
     1512    0.041    0.000    0.115    0.000 functional.py:1195(relu)
      981    0.020    0.000    0.113    0.000 metric.py:430(__setattr__)
       18    0.002    0.000    0.100    0.006 result.py:432(log)
   203/75    0.013    0.000    0.097    0.001 apply_func.py:70(apply_to_collection)
        2    0.000    0.000    0.080    0.040 result.py:496(register_key)
        2    0.000    0.000    0.080    0.040 result.py:502(fn)
     8205    0.068    0.000    0.068    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.064    0.032 result.py:332(to)
     5868    0.058    0.000    0.058    0.000 {built-in method torch._C._get_tracing_state}
       27    0.002    0.000    0.058    0.002 deeplabv3.py:58(forward)
     1323    0.053    0.000    0.053    0.000 {built-in method relu_}
     1620    0.034    0.000    0.047    0.000 functional.py:2100(_verify_batch_size)
       27    0.029    0.001    0.045    0.002 helper.py:65(extract_masks)
     1620    0.028    0.000    0.043    0.000 batchnorm.py:283(_check_input_dim)
     1620    0.028    0.000    0.043    0.000 __init__.py:31(__get__)
     1080    0.039    0.000    0.039    0.000 {built-in method softmax}
    156/8    0.009    0.000    0.032    0.004 copy.py:128(deepcopy)
     3293    0.028    0.000    0.028    0.000 {built-in method torch._C._has_torch_function_unary}
        9    0.001    0.000    0.025    0.003 metric.py:360(wrapped_func)
       20    0.000    0.000    0.024    0.001 inspect.py:3091(signature)
       20    0.000    0.000    0.023    0.001 inspect.py:2839(from_callable)
    40/20    0.002    0.000    0.023    0.001 inspect.py:2206(_signature_from_callable)
       18    0.001    0.000    0.022    0.001 signature_utils.py:18(is_param_in_hook_signature)
     2124    0.019    0.000    0.019    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
     1080    0.019    0.000    0.019    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
     1768    0.018    0.000    0.018    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     1080    0.018    0.000    0.018    0.000 {built-in method reshape}
       54    0.007    0.000    0.018    0.000 functional.py:3364(interpolate)
      405    0.011    0.000    0.017    0.000 container.py:109(__iter__)
        2    0.000    0.000    0.016    0.008 result.py:205(__init__)
        9    0.002    0.000    0.015    0.002 metric.py:396(reset)
      6/4    0.001    0.000    0.015    0.004 copy.py:258(_reconstruct)
     1620    0.015    0.000    0.015    0.000 {built-in method torch._C._get_cudnn_enabled}
      475    0.008    0.000    0.013    0.000 abc.py:96(__instancecheck__)
       20    0.003    0.000    0.013    0.001 inspect.py:2112(_signature_from_function)
        6    0.000    0.000    0.012    0.002 {method '__reduce_ex__' of 'object' objects}
      8/4    0.002    0.000    0.012    0.003 copy.py:226(_deepcopy_dict)
        9    0.000    0.000    0.012    0.001 data.py:247(_squeeze_if_scalar)
        2    0.000    0.000    0.012    0.006 result.py:182(__getstate__)
     45/9    0.002    0.000    0.012    0.001 data.py:166(apply_to_collection)
        2    0.001    0.000    0.011    0.006 metric.py:83(__init__)
       27    0.002    0.000    0.011    0.000 loss.py:711(forward)
        2    0.000    0.000    0.011    0.005 dataclasses.py:1052(asdict)
     36/2    0.003    0.000    0.011    0.005 dataclasses.py:1076(_asdict_inner)
        9    0.000    0.000    0.010    0.001 data.py:204(<dictcomp>)
      130    0.002    0.000    0.010    0.000 {built-in method builtins.setattr}
       54    0.001    0.000    0.009    0.000 trainer.py:1957(training)
        9    0.003    0.000    0.008    0.001 metrics.py:64(compute)
      189    0.008    0.000    0.008    0.000 {built-in method relu}
       27    0.002    0.000    0.008    0.000 functional.py:2765(binary_cross_entropy_with_logits)
      133    0.002    0.000    0.008    0.000 apply_func.py:65(_is_dataclass_instance)
       18    0.001    0.000    0.008    0.000 trainer.py:2151(_results)
       18    0.000    0.000    0.008    0.000 result.py:511(update_metrics)
       81    0.001    0.000    0.008    0.000 typing.py:768(__instancecheck__)
       54    0.003    0.000    0.007    0.000 enums.py:30(__eq__)
       18    0.001    0.000    0.007    0.000 apply_func.py:157(apply_to_collections)
       18    0.001    0.000    0.007    0.000 result.py:512(fn)
       81    0.002    0.000    0.006    0.000 typing.py:771(__subclasscheck__)
      133    0.003    0.000    0.006    0.000 dataclasses.py:1045(is_dataclass)
        2    0.000    0.000    0.006    0.003 imports.py:67(_compare_version)
       27    0.006    0.000    0.006    0.000 {built-in method binary_cross_entropy_with_logits}
      108    0.006    0.000    0.006    0.000 {method 'amax' of 'torch._C._TensorBase' objects}
       27    0.001    0.000    0.006    0.000 pooling.py:161(forward)
       18    0.000    0.000    0.005    0.000 result.py:271(forward)
      475    0.005    0.000    0.005    0.000 {built-in method _abc._abc_instancecheck}
      108    0.005    0.000    0.005    0.000 {method 'eq' of 'torch._C._TensorBase' objects}
       40    0.002    0.000    0.005    0.000 inspect.py:2760(__init__)
        9    0.003    0.000    0.005    0.001 helper.py:3(get_targets_from_annotations)
       27    0.001    0.000    0.005    0.000 _jit_internal.py:355(fn)
       60    0.002    0.000    0.005    0.000 inspect.py:2477(__init__)
       27    0.001    0.000    0.005    0.000 dropout.py:57(forward)
       20    0.001    0.000    0.005    0.000 inspect.py:1800(_signature_bound_method)
       27    0.000    0.000    0.005    0.000 pooling.py:1131(forward)
       54    0.005    0.000    0.005    0.000 {built-in method torch._C._nn.upsample_bilinear2d}
    63/45    0.001    0.000    0.005    0.000 {built-in method builtins.next}
        4    0.000    0.000    0.004    0.001 metric.py:122(add_state)
       27    0.001    0.000    0.004    0.000 functional.py:1059(dropout)
       27    0.001    0.000    0.004    0.000 functional.py:1022(adaptive_avg_pool2d)
       27    0.001    0.000    0.004    0.000 functional.py:643(_max_pool2d)
      450    0.004    0.000    0.004    0.000 {built-in method builtins.iter}
       18    0.002    0.000    0.004    0.000 result.py:223(update)
       18    0.001    0.000    0.004    0.000 fit_loop.py:142(_results)
       18    0.001    0.000    0.004    0.000 trainer.py:2126(_active_loop)
       91    0.002    0.000    0.004    0.000 {built-in method builtins.issubclass}
      133    0.002    0.000    0.003    0.000 apply_func.py:60(_is_namedtuple)
        4    0.001    0.000    0.003    0.001 tensor.py:51(__deepcopy__)
       27    0.003    0.000    0.003    0.000 {built-in method max_pool2d}
        4    0.000    0.000    0.003    0.001 __init__.py:109(import_module)
    27/18    0.000    0.000    0.003    0.000 contextlib.py:108(__enter__)
       62    0.002    0.000    0.003    0.000 grad_mode.py:200(__init__)
      318    0.003    0.000    0.003    0.000 {built-in method builtins.getattr}
      108    0.002    0.000    0.003    0.000 types.py:171(__get__)
        4    0.000    0.000    0.003    0.001 <frozen importlib._bootstrap>:1002(_gcd_import)
       31    0.001    0.000    0.003    0.000 grad_mode.py:119(__enter__)
      325    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}
       54    0.003    0.000    0.003    0.000 {method 'sigmoid' of 'torch._C._TensorBase' objects}
       27    0.003    0.000    0.003    0.000 {built-in method cat}
      264    0.003    0.000    0.003    0.000 {built-in method builtins.id}
       20    0.000    0.000    0.003    0.000 inspect.py:2853(replace)
        4    0.000    0.000    0.003    0.001 <frozen importlib._bootstrap>:986(_find_and_load)
      246    0.003    0.000    0.003    0.000 {built-in method builtins.hasattr}
       54    0.003    0.000    0.003    0.000 {method 'clone' of 'torch._C._TensorBase' objects}
       40    0.001    0.000    0.002    0.000 result.py:90(_generate_sync_fn)
       18    0.001    0.000    0.002    0.000 tensor.py:575(__iter__)
    36/27    0.001    0.000    0.002    0.000 contextlib.py:117(__exit__)
       87    0.001    0.000    0.002    0.000 abc.py:100(__subclasscheck__)
        9    0.001    0.000    0.002    0.000 loss.py:115(mask_similarity_loss)
       20    0.000    0.000    0.002    0.000 <string>:2(__init__)
        4    0.001    0.000    0.002    0.001 version.py:292(__init__)
       18    0.001    0.000    0.002    0.000 result.py:147(sync)
       31    0.001    0.000    0.002    0.000 grad_mode.py:123(__exit__)
       27    0.002    0.000    0.002    0.000 {built-in method dropout}
        8    0.001    0.000    0.002    0.000 dataclasses.py:1022(fields)
        2    0.000    0.000    0.002    0.001 imports.py:43(_module_available)
       36    0.001    0.000    0.002    0.000 __init__.py:46(is_available)
       36    0.002    0.000    0.002    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.002    0.000 result.py:57(__post_init__)
       80    0.001    0.000    0.002    0.000 inspect.py:2809(<genexpr>)
        8    0.000    0.000    0.002    0.000 apply_func.py:245(move_data_to_device)
       27    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.adaptive_avg_pool2d}
       20    0.000    0.000    0.002    0.000 result.py:121(__post_init__)
       18    0.000    0.000    0.002    0.000 memory.py:41(recursive_detach)
      164    0.002    0.000    0.002    0.000 result.py:299(__setattr__)
       18    0.000    0.000    0.002    0.000 precision_plugin.py:232(train_step_context)
        9    0.000    0.000    0.002    0.000 lightning.py:577(__to_tensor)
       60    0.001    0.000    0.002    0.000 enum.py:289(__call__)
       20    0.001    0.000    0.002    0.000 inspect.py:493(unwrap)
      4/2    0.000    0.000    0.002    0.001 copy.py:209(_deepcopy_tuple)
       18    0.000    0.000    0.002    0.000 metric.py:325(sync_context)
      4/2    0.000    0.000    0.002    0.001 copy.py:210(<listcomp>)
       42    0.001    0.000    0.001    0.000 dataclasses.py:1040(_is_dataclass_instance)
       62    0.001    0.000    0.001    0.000 {method 'to' of 'torch._C._TensorBase' objects}
       18    0.000    0.000    0.001    0.000 result.py:74(op)
       20    0.001    0.000    0.001    0.000 result.py:126(_parse_reduce_fx)
       27    0.000    0.000    0.001    0.000 contextlib.py:238(helper)
        4    0.000    0.000    0.001    0.000 storage.py:44(__deepcopy__)
       36    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
       18    0.001    0.000    0.001    0.000 fx_validator.py:202(check_logging_and_get_default_levels)
        4    0.000    0.000    0.001    0.000 dataclasses.py:1234(replace)
       54    0.001    0.000    0.001    0.000 {built-in method empty}
        9    0.001    0.000    0.001    0.000 {built-in method full}
        4    0.000    0.000    0.001    0.000 storage.py:60(clone)
      126    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
       40    0.001    0.000    0.001    0.000 inspect.py:158(isfunction)
       27    0.001    0.000    0.001    0.000 container.py:186(__iter__)
        9    0.000    0.000    0.001    0.000 metric.py:267(sync)
       31    0.001    0.000    0.001    0.000 grad_mode.py:114(__init__)
       20    0.001    0.000    0.001    0.000 copy.py:242(_keep_alive)
        8    0.000    0.000    0.001    0.000 apply_func.py:262(batch_to)
       13    0.001    0.000    0.001    0.000 {built-in method tensor}
       90    0.001    0.000    0.001    0.000 copy.py:182(_deepcopy_atomic)
        2    0.000    0.000    0.001    0.000 metric.py:258(_wrap_update)
        4    0.000    0.000    0.001    0.000 functools.py:34(update_wrapper)
      108    0.001    0.000    0.001    0.000 enum.py:689(value)
       87    0.001    0.000    0.001    0.000 {built-in method _abc._abc_subclasscheck}
        8    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
       93    0.001    0.000    0.001    0.000 {built-in method torch._C.is_grad_enabled}
       27    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
      100    0.001    0.000    0.001    0.000 inspect.py:2527(name)
        4    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
       27    0.001    0.000    0.001    0.000 trainer.py:1615(training_type_plugin)
       27    0.001    0.000    0.001    0.000 _VF.py:25(__getattr__)
       54    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.001    0.000 copy.py:263(<genexpr>)
       76    0.001    0.000    0.001    0.000 dataclasses.py:1037(<genexpr>)
        9    0.000    0.000    0.001    0.000 metric.py:213(<dictcomp>)
       27    0.000    0.000    0.001    0.000 container.py:329(items)
       16    0.000    0.000    0.001    0.000 <string>:2(__eq__)
        9    0.000    0.000    0.001    0.000 metric.py:41(jit_distributed_available)
        2    0.000    0.000    0.001    0.000 device_dtype_mixin.py:26(__init__)
        4    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:147(__enter__)
       27    0.000    0.000    0.001    0.000 utils.py:30(_list_with_default)
        2    0.000    0.000    0.001    0.000 result.py:279(_wrap_compute)
       18    0.000    0.000    0.001    0.000 memory.py:56(detach_and_move)
       80    0.001    0.000    0.001    0.000 inspect.py:2539(kind)
        4    0.000    0.000    0.001    0.000 __init__.py:216(__init__)
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       18    0.001    0.000    0.001    0.000 {method 'unbind' of 'torch._C._TensorBase' objects}
       62    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
       60    0.001    0.000    0.001    0.000 enum.py:586(__new__)
       18    0.000    0.000    0.001    0.000 result.py:413(_extract_batch_size)
       60    0.001    0.000    0.001    0.000 {method 'isidentifier' of 'str' objects}
       20    0.000    0.000    0.001    0.000 inspect.py:513(_is_wrapper)
        4    0.000    0.000    0.000    0.000 _utils.py:8(_get_device_index)
        2    0.000    0.000    0.000    0.000 module.py:250(__init__)
       58    0.000    0.000    0.000    0.000 result.py:70(op)
        8    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
        9    0.000    0.000    0.000    0.000 {method 'abs' of 'torch._C._TensorBase' objects}
       53    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       18    0.000    0.000    0.000    0.000 {method 'unsqueeze' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 result.py:191(__setstate__)
       48    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       36    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_getDeviceCount}
        9    0.000    0.000    0.000    0.000 {built-in method ones_like}
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        9    0.000    0.000    0.000    0.000 device_dtype_mixin.py:40(device)
        4    0.000    0.000    0.000    0.000 typing.py:255(inner)
        8    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
       43    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
       31    0.000    0.000    0.000    0.000 _jit_internal.py:833(is_scripting)
        1    0.000    0.000    0.000    0.000 result.py:595(reset)
       40    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
       36    0.000    0.000    0.000    0.000 base.py:54(trainer)
       40    0.000    0.000    0.000    0.000 result.py:80(group)
       36    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       38    0.000    0.000    0.000    0.000 inspect.py:2845(parameters)
       40    0.000    0.000    0.000    0.000 inspect.py:2531(default)
        9    0.000    0.000    0.000    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
       18    0.000    0.000    0.000    0.000 helper.py:13(<listcomp>)
        8    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
       36    0.000    0.000    0.000    0.000 result.py:60(should)
       18    0.000    0.000    0.000    0.000 logger_connector.py:296(should_reset_tensors)
        9    0.000    0.000    0.000    0.000 __init__.py:6(is_available)
       27    0.000    0.000    0.000    0.000 _reduction.py:7(get_enum)
        4    0.000    0.000    0.000    0.000 _utils.py:462(_get_device_index)
        4    0.000    0.000    0.000    0.000 version.py:495(_cmpkey)
        8    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
       18    0.000    0.000    0.000    0.000 {built-in method is_floating_point}
       27    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
       18    0.000    0.000    0.000    0.000 fx_validator.py:165(check_logging)
        8    0.000    0.000    0.000    0.000 typing.py:329(__hash__)
       20    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
       18    0.000    0.000    0.000    0.000 fx_validator.py:188(check_logging_levels)
       20    0.000    0.000    0.000    0.000 result.py:142(sync)
        9    0.000    0.000    0.000    0.000 helper.py:53(get_target_dictionary)
       18    0.000    0.000    0.000    0.000 fx_validator.py:177(get_default_logging_levels)
       20    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       18    0.000    0.000    0.000    0.000 result.py:97(__call__)
       18    0.000    0.000    0.000    0.000 result.py:101(no_op)
       18    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
       16    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
       16    0.000    0.000    0.000    0.000 version.py:303(<genexpr>)
       18    0.000    0.000    0.000    0.000 precision_plugin.py:227(forward_context)
        4    0.000    0.000    0.000    0.000 copyreg.py:90(__newobj__)
        2    0.000    0.000    0.000    0.000 imports.py:25(_package_available)
       16    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
       16    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
       16    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
       10    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 <string>:1(__new__)
        2    0.000    0.000    0.000    0.000 {built-in method _operator.ge}
       12    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:937(_sanity_check)
        4    0.000    0.000    0.000    0.000 tensor.py:906(grad)
       12    0.000    0.000    0.000    0.000 version.py:441(_parse_letter_version)
        9    0.000    0.000    0.000    0.000 distributed_c10d.py:335(is_initialized)
        9    0.000    0.000    0.000    0.000 helper.py:8(<listcomp>)
        8    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        4    0.000    0.000    0.000    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
        4    0.000    0.000    0.000    0.000 version.py:482(_parse_local_version)
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:215(post_training_step)
        9    0.000    0.000    0.000    0.000 metric.py:303(unsync)
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
        2    0.000    0.000    0.000    0.000 util.py:73(find_spec)
        2    0.000    0.000    0.000    0.000 {method '__setstate__' of 'functools.partial' objects}
        8    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
        2    0.000    0.000    0.000    0.000 version.py:99(__ge__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        6    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        6    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
        6    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        6    0.000    0.000    0.000    0.000 version.py:511(<lambda>)
        2    0.000    0.000    0.000    0.000 result.py:178(is_custom_reduction)
        4    0.000    0.000    0.000    0.000 {method 'new' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        4    0.000    0.000    0.000    0.000 result.py:162(is_mean_reduction)
        4    0.000    0.000    0.000    0.000 functools.py:64(wraps)
        4    0.000    0.000    0.000    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 __init__.py:220(__enter__)
        4    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 __init__.py:228(__exit__)
        4    0.000    0.000    0.000    0.000 storage.py:13(__init__)
        1    0.000    0.000    0.000    0.000 result.py:395(__init__)
        2    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
        2    0.000    0.000    0.000    0.000 result.py:170(is_max_reduction)
        2    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch._C.get_default_dtype}
        2    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
        2    0.000    0.000    0.000    0.000 result.py:174(is_min_reduction)
        2    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}



Profile stats for: training_step_end
         162 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       18    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       27    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       18    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 lightning.py:696(training_step_end)
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:227(training_step_end)
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: zero_grad
         234 function calls in 0.032 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.000    0.000    0.032    0.004 optimizer_loop.py:311(zero_grad_fn)
        9    0.000    0.000    0.032    0.004 optimizer_loop.py:391(_on_before_zero_grad)
        9    0.000    0.000    0.031    0.003 trainer.py:1481(call_hook)
        9    0.000    0.000    0.029    0.003 contextlib.py:108(__enter__)
        9    0.000    0.000    0.028    0.003 {built-in method builtins.next}
        9    0.000    0.000    0.028    0.003 base.py:68(profile)
        9    0.000    0.000    0.028    0.003 advanced.py:61(start)
        9    0.028    0.003    0.028    0.003 {method 'enable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        9    0.001    0.000    0.001    0.000 module.py:950(__setattr__)
        9    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        9    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
        9    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        9    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       36    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       27    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
        9    0.000    0.000    0.000    0.000 progress.py:126(increment_ready)
        9    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 base.py:54(trainer)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_before_zero_grad
         495 function calls in 0.008 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.006    0.001 callback_hook.py:309(on_before_zero_grad)
       45    0.001    0.000    0.005    0.000 trainer.py:1686(lightning_module)
       45    0.001    0.000    0.003    0.000 accelerator.py:172(lightning_module)
       45    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       54    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       45    0.000    0.000    0.000    0.000 base.py:329(on_before_zero_grad)
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 hooks.py:220(on_before_zero_grad)
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: backward
         297 function calls in 7.087 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.000    0.000    7.087    0.787 optimizer_loop.py:326(backward_fn)
        9    0.000    0.000    7.086    0.787 accelerator.py:305(backward)
        9    0.000    0.000    7.085    0.787 precision_plugin.py:64(pre_backward)
        9    0.000    0.000    7.085    0.787 trainer.py:1481(call_hook)
        9    0.000    0.000    7.082    0.787 contextlib.py:108(__enter__)
        9    0.000    0.000    7.082    0.787 {built-in method builtins.next}
        9    0.000    0.000    7.082    0.787 base.py:68(profile)
        9    0.000    0.000    7.082    0.787 advanced.py:61(start)
        9    7.082    0.787    7.082    0.787 {method 'enable' of '_lsprof.Profiler' objects}
       18    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       18    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
        9    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        9    0.000    0.000    0.001    0.000 module.py:950(__setattr__)
       18    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
       54    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        9    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
       27    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       18    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 base.py:54(trainer)
        9    0.000    0.000    0.000    0.000 training_type_plugin.py:156(pre_backward)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_before_backward
         495 function calls in 0.009 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.007    0.001 callback_hook.py:294(on_before_backward)
       45    0.001    0.000    0.006    0.000 trainer.py:1686(lightning_module)
       45    0.001    0.000    0.004    0.000 accelerator.py:172(lightning_module)
       45    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       54    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       45    0.000    0.000    0.000    0.000 base.py:315(on_before_backward)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 hooks.py:240(on_before_backward)
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_after_backward
         495 function calls in 0.015 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.002    0.000    0.012    0.001 callback_hook.py:299(on_after_backward)
       45    0.002    0.000    0.010    0.000 trainer.py:1686(lightning_module)
       45    0.001    0.000    0.007    0.000 accelerator.py:172(lightning_module)
       45    0.001    0.000    0.005    0.000 training_type_plugin.py:171(lightning_module)
       45    0.002    0.000    0.004    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.002    0.000 contextlib.py:117(__exit__)
       90    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       54    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.001    0.000 advanced.py:66(stop)
       45    0.001    0.000    0.001    0.000 base.py:319(on_after_backward)
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 hooks.py:248(on_after_backward)
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_before_optimizer_step
         495 function calls in 0.008 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.006    0.001 callback_hook.py:304(on_before_optimizer_step)
       45    0.001    0.000    0.005    0.000 trainer.py:1686(lightning_module)
       45    0.001    0.000    0.003    0.000 accelerator.py:172(lightning_module)
       45    0.001    0.000    0.002    0.000 training_type_plugin.py:171(lightning_module)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       54    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       45    0.000    0.000    0.000    0.000 base.py:323(on_before_optimizer_step)
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.000    0.000 hooks.py:256(on_before_optimizer_step)
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_train_batch_end
         22397 function calls (22352 primitive calls) in 0.377 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.002    0.000    0.375    0.042 callback_hook.py:175(on_train_batch_end)
        9    0.001    0.000    0.282    0.031 tqdm_progress.py:233(on_train_batch_end)
       18    0.001    0.000    0.250    0.014 std.py:1360(refresh)
       18    0.001    0.000    0.247    0.014 std.py:1491(display)
       54    0.001    0.000    0.216    0.004 utils.py:325(disp_len)
       54    0.001    0.000    0.214    0.004 utils.py:320(_text_width)
       54    0.054    0.001    0.213    0.004 {built-in method builtins.sum}
     6802    0.107    0.000    0.159    0.000 utils.py:321(<genexpr>)
       18    0.001    0.000    0.159    0.009 std.py:1126(__repr__)
       18    0.009    0.001    0.155    0.009 std.py:343(format_meter)
        9    0.000    0.000    0.129    0.014 tqdm_progress.py:324(_update_bar)
        9    0.001    0.000    0.129    0.014 std.py:1429(set_postfix)
        9    0.001    0.000    0.129    0.014 std.py:1222(update)
       18    0.001    0.000    0.087    0.005 std.py:336(print_status)
       18    0.000    0.000    0.085    0.005 utils.py:333(disp_trim)
       45    0.002    0.000    0.083    0.002 signature_utils.py:18(is_param_in_hook_signature)
       45    0.001    0.000    0.081    0.002 inspect.py:3091(signature)
       45    0.001    0.000    0.080    0.002 inspect.py:2839(from_callable)
    90/45    0.005    0.000    0.079    0.002 inspect.py:2206(_signature_from_callable)
     6748    0.053    0.000    0.053    0.000 {built-in method unicodedata.east_asian_width}
       45    0.010    0.000    0.050    0.001 inspect.py:2112(_signature_from_function)
       90    0.010    0.000    0.024    0.000 inspect.py:2760(__init__)
      297    0.010    0.000    0.023    0.000 inspect.py:2477(__init__)
        9    0.000    0.000    0.022    0.002 base.py:185(get_metrics)
        9    0.000    0.000    0.018    0.002 trainer.py:2147(progress_bar_metrics)
        9    0.000    0.000    0.018    0.002 logger_connector.py:349(progress_bar_metrics)
       45    0.002    0.000    0.018    0.000 inspect.py:1800(_signature_bound_method)
        9    0.000    0.000    0.014    0.002 logger_connector.py:317(metrics)
       45    0.001    0.000    0.014    0.000 inspect.py:2853(replace)
       27    0.001    0.000    0.010    0.000 trainer.py:2151(_results)
      918    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
       63    0.003    0.000    0.008    0.000 enums.py:30(__eq__)
       54    0.001    0.000    0.008    0.000 trainer.py:1957(training)
      342    0.005    0.000    0.008    0.000 inspect.py:2809(<genexpr>)
      297    0.005    0.000    0.008    0.000 enum.py:289(__call__)
        9    0.002    0.000    0.007    0.001 result.py:555(metrics)
       36    0.004    0.000    0.007    0.000 utils.py:214(_is_ascii)
       27    0.001    0.000    0.005    0.000 trainer.py:2126(_active_loop)
       45    0.001    0.000    0.005    0.000 trainer.py:1686(lightning_module)
       27    0.001    0.000    0.005    0.000 fit_loop.py:142(_results)
      549    0.004    0.000    0.004    0.000 inspect.py:2527(name)
        9    0.000    0.000    0.004    0.000 lightning.py:1791(get_progress_bar_dict)
       18    0.001    0.000    0.004    0.000 std.py:1473(format_dict)
      162    0.002    0.000    0.003    0.000 {method 'format' of 'str' objects}
       45    0.001    0.000    0.003    0.000 accelerator.py:172(lightning_module)
       45    0.002    0.000    0.003    0.000 inspect.py:493(unwrap)
        9    0.001    0.000    0.003    0.000 base.py:217(get_standard_metrics)
       45    0.001    0.000    0.003    0.000 apply_func.py:70(apply_to_collection)
      126    0.002    0.000    0.003    0.000 types.py:171(__get__)
        9    0.000    0.000    0.003    0.000 model_checkpoint.py:280(on_train_batch_end)
      351    0.003    0.000    0.003    0.000 {method 'get' of 'dict' objects}
       18    0.001    0.000    0.003    0.000 tqdm_progress.py:41(format_num)
      378    0.003    0.000    0.003    0.000 {built-in method builtins.ord}
      342    0.003    0.000    0.003    0.000 inspect.py:2539(kind)
       45    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
      297    0.003    0.000    0.003    0.000 {method 'isidentifier' of 'str' objects}
      297    0.003    0.000    0.003    0.000 enum.py:586(__new__)
      297    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}
       36    0.001    0.000    0.002    0.000 std.py:260(format_interval)
        9    0.000    0.000    0.002    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
       18    0.001    0.000    0.002    0.000 utils.py:273(_screen_shape_linux)
       90    0.001    0.000    0.002    0.000 inspect.py:158(isfunction)
       18    0.000    0.000    0.002    0.000 std.py:330(fp_write)
      252    0.002    0.000    0.002    0.000 inspect.py:2531(default)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
       18    0.001    0.000    0.002    0.000 std.py:282(format_num)
       36    0.001    0.000    0.002    0.000 utils.py:141(inner)
        9    0.000    0.000    0.001    0.000 metrics.py:24(metrics_to_scalars)
        9    0.000    0.000    0.001    0.000 supporters.py:93(mean)
        9    0.000    0.000    0.001    0.000 trainer.py:2016(sanity_checking)
        9    0.001    0.000    0.001    0.000 supporters.py:105(_agg_memory)
        9    0.000    0.000    0.001    0.000 {method 'join' of 'str' objects}
       18    0.001    0.000    0.001    0.000 {built-in method fcntl.ioctl}
       18    0.001    0.000    0.001    0.000 std.py:189(__format__)
      126    0.001    0.000    0.001    0.000 enum.py:689(value)
       45    0.001    0.000    0.001    0.000 inspect.py:513(_is_wrapper)
        9    0.000    0.000    0.001    0.000 metrics.py:32(to_item)
      126    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
       18    0.001    0.000    0.001    0.000 std.py:104(acquire)
      117    0.001    0.000    0.001    0.000 {built-in method builtins.len}
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
      108    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
       18    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
       18    0.001    0.000    0.001    0.000 std.py:108(release)
       90    0.001    0.000    0.001    0.000 inspect.py:2845(parameters)
       36    0.001    0.000    0.001    0.000 std.py:1455(<genexpr>)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
       18    0.001    0.000    0.001    0.000 {method 'write' of '_io.TextIOWrapper' objects}
       18    0.000    0.000    0.001    0.000 result.py:544(_forked_name)
       18    0.000    0.000    0.001    0.000 trainer.py:2031(global_step)
       27    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.divmod}
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       81    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
        9    0.000    0.000    0.001    0.000 tqdm_progress.py:321(_should_update)
        9    0.001    0.000    0.001    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
       27    0.000    0.000    0.001    0.000 result.py:538(<genexpr>)
       18    0.000    0.000    0.001    0.000 result.py:519(_get_cache)
       18    0.000    0.000    0.001    0.000 std.py:156(__init__)
       36    0.001    0.000    0.001    0.000 {built-in method time.time}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       54    0.001    0.000    0.001    0.000 {method 'sub' of 're.Pattern' objects}
       18    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
       54    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       18    0.000    0.000    0.000    0.000 result.py:157(forked_name)
       54    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       45    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       45    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       18    0.000    0.000    0.000    0.000 {built-in method now}
       45    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       45    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       36    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
       27    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        9    0.000    0.000    0.000    0.000 result.py:536(valid_items)
       27    0.000    0.000    0.000    0.000 base.py:110(on_train_batch_end)
       27    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
       27    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       27    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
       18    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
       27    0.000    0.000    0.000    0.000 base.py:54(trainer)
       27    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
       18    0.000    0.000    0.000    0.000 std.py:170(colour)
       18    0.000    0.000    0.000    0.000 utils.py:57(__init__)
       18    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
       18    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
       18    0.000    0.000    0.000    0.000 utils.py:61(__format__)
       18    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
       18    0.000    0.000    0.000    0.000 result.py:570(any_tensor)
       18    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
       18    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
       18    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
       18    0.000    0.000    0.000    0.000 result.py:153(forked)
       18    0.000    0.000    0.000    0.000 std.py:166(colour)
       18    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
       18    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        9    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        9    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 typing_extensions.py:1603(_dict_new)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        9    0.000    0.000    0.000    0.000 base.py:164(on_train_batch_end)
        9    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
        9    0.000    0.000    0.000    0.000 hooks.py:93(on_train_batch_end)
        9    0.000    0.000    0.000    0.000 fit_loop.py:123(running_loss)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        9    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        9    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: on_batch_end
         504 function calls in 0.008 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        9    0.001    0.000    0.006    0.001 callback_hook.py:160(on_batch_end)
       45    0.001    0.000    0.005    0.000 trainer.py:1686(lightning_module)
       45    0.001    0.000    0.004    0.000 accelerator.py:172(lightning_module)
       45    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
       45    0.001    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
       90    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
        9    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
        9    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       18    0.000    0.000    0.001    0.000 {built-in method builtins.getattr}
        9    0.000    0.000    0.001    0.000 base.py:68(profile)
       54    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        9    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       45    0.000    0.000    0.000    0.000 base.py:226(on_batch_end)
        9    0.000    0.000    0.000    0.000 module.py:934(__getattr__)
        9    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        9    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        9    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        9    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}



Profile stats for: get_validate_batch
         210 function calls (190 primitive calls) in 0.146 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    30/20    0.001    0.000    0.145    0.007 contextlib.py:108(__enter__)
    30/20    0.000    0.000    0.144    0.007 {built-in method builtins.next}
       10    0.000    0.000    0.144    0.014 fetching.py:287(apply_profiler)
       10    0.000    0.000    0.143    0.014 base.py:68(profile)
       10    0.000    0.000    0.143    0.014 advanced.py:61(start)
       10    0.143    0.014    0.143    0.014 {method 'enable' of '_lsprof.Profiler' objects}
       30    0.001    0.000    0.001    0.000 contextlib.py:238(helper)
       30    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
       30    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)
       10    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_validate_batch
         940 function calls (908 primitive calls) in 0.142 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    40/19    0.001    0.000    0.142    0.007 {built-in method builtins.next}
       10    0.001    0.000    0.140    0.014 dataloader.py:513(__next__)
       10    0.001    0.000    0.138    0.014 dataloader.py:1152(_next_data)
        9    0.000    0.000    0.071    0.008 dataloader.py:1119(_get_data)
        9    0.000    0.000    0.070    0.008 dataloader.py:973(_try_get_data)
        9    0.001    0.000    0.070    0.008 queue.py:153(get)
       47    0.068    0.001    0.068    0.001 {method 'acquire' of '_thread.lock' objects}
        4    0.000    0.000    0.068    0.017 threading.py:270(wait)
        1    0.000    0.000    0.065    0.065 dataloader.py:1254(_shutdown_workers)
        4    0.000    0.000    0.058    0.014 process.py:142(join)
        4    0.000    0.000    0.057    0.014 popen_fork.py:40(wait)
        4    0.001    0.000    0.056    0.014 connection.py:917(wait)
        4    0.000    0.000    0.054    0.013 selectors.py:402(select)
        4    0.053    0.013    0.053    0.013 {method 'poll' of 'select.poll' objects}
        6    0.000    0.000    0.002    0.000 queues.py:80(put)
        5    0.000    0.000    0.002    0.000 queues.py:134(close)
        4    0.000    0.000    0.002    0.000 dataloader.py:1228(_mark_worker_as_unavailable)
        5    0.000    0.000    0.002    0.000 util.py:205(__call__)
    20/10    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
       21    0.001    0.000    0.001    0.000 threading.py:341(notify)
        5    0.000    0.000    0.001    0.000 queues.py:200(_finalize_close)
        9    0.000    0.000    0.001    0.000 dataloader.py:1221(_process_data)
        1    0.000    0.000    0.001    0.001 queues.py:158(_start_thread)
       10    0.000    0.000    0.001    0.000 fetching.py:287(apply_profiler)
       10    0.000    0.000    0.001    0.000 threading.py:1017(_wait_for_tstate_lock)
        4    0.000    0.000    0.001    0.000 selectors.py:351(register)
        9    0.000    0.000    0.001    0.000 dataloader.py:1201(_try_put_index)
        1    0.000    0.000    0.001    0.001 threading.py:979(join)
       10    0.000    0.000    0.001    0.000 profiler.py:615(__enter__)
       10    0.000    0.000    0.001    0.000 profiler.py:607(__init__)
        8    0.000    0.000    0.001    0.000 popen_fork.py:24(poll)
        4    0.000    0.000    0.001    0.000 synchronize.py:327(is_set)
        4    0.000    0.000    0.001    0.000 selectors.py:234(register)
       22    0.000    0.000    0.001    0.000 threading.py:246(__enter__)
        1    0.000    0.000    0.001    0.001 threading.py:834(start)
       22    0.000    0.000    0.001    0.000 threading.py:249(__exit__)
       25    0.000    0.000    0.001    0.000 threading.py:261(_is_owned)
       10    0.000    0.000    0.001    0.000 base.py:68(profile)
        9    0.000    0.000    0.001    0.000 threading.py:1071(is_alive)
       10    0.001    0.000    0.001    0.000 {built-in method zeros}
       10    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_enter}
       16    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
       10    0.000    0.000    0.000    0.000 profiler.py:619(__exit__)
        1    0.000    0.000    0.000    0.000 threading.py:540(wait)
        4    0.000    0.000    0.000    0.000 selectors.py:347(__init__)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        4    0.000    0.000    0.000    0.000 selectors.py:202(__exit__)
        9    0.000    0.000    0.000    0.000 dataloader.py:507(_next_index)
       43    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        4    0.000    0.000    0.000    0.000 signal_handling.py:63(handler)
        5    0.000    0.000    0.000    0.000 synchronize.py:229(__enter__)
        4    0.000    0.000    0.000    0.000 process.py:153(is_alive)
        4    0.000    0.000    0.000    0.000 selectors.py:215(_fileobj_lookup)
        5    0.000    0.000    0.000    0.000 connection.py:173(close)
        9    0.000    0.000    0.000    0.000 queue.py:216(_get)
       12    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
        5    0.000    0.000    0.000    0.000 queues.py:150(cancel_join_thread)
        1    0.000    0.000    0.000    0.000 synchronize.py:334(set)
        4    0.000    0.000    0.000    0.000 selectors.py:268(close)
        5    0.000    0.000    0.000    0.000 synchronize.py:94(__enter__)
       10    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_exit}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._error_if_any_worker_fails}
       15    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
       15    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        4    0.000    0.000    0.000    0.000 selectors.py:21(_fileobj_to_fd)
        1    0.000    0.000    0.000    0.000 threading.py:519(set)
        5    0.000    0.000    0.000    0.000 synchronize.py:232(__exit__)
        5    0.000    0.000    0.000    0.000 connection.py:360(_close)
        1    0.000    0.000    0.000    0.000 threading.py:761(__init__)
        4    0.000    0.000    0.000    0.000 <string>:1(__new__)
       22    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        4    0.000    0.000    0.000    0.000 {built-in method posix.waitpid}
       22    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        4    0.000    0.000    0.000    0.000 selectors.py:209(__init__)
      2/1    0.000    0.000    0.000    0.000 {method 'throw' of 'generator' objects}
        1    0.000    0.000    0.000    0.000 {built-in method _thread.start_new_thread}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        4    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 sampler.py:225(__iter__)
       14    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 util.py:186(__init__)
       15    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        5    0.000    0.000    0.000    0.000 synchronize.py:97(__exit__)
       13    0.000    0.000    0.000    0.000 util.py:48(debug)
        1    0.000    0.000    0.000    0.000 threading.py:364(notify_all)
        1    0.000    0.000    0.000    0.000 synchronize.py:296(notify_all)
        4    0.000    0.000    0.000    0.000 threading.py:258(_acquire_restore)
       12    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        8    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}
        4    0.000    0.000    0.000    0.000 threading.py:255(_release_save)
        5    0.000    0.000    0.000    0.000 {built-in method posix.close}
        8    0.000    0.000    0.000    0.000 process.py:99(_check_closed)
       10    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 synchronize.py:270(notify)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        9    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
        6    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        5    0.000    0.000    0.000    0.000 {method '__enter__' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 threading.py:944(_stop)
        4    0.000    0.000    0.000    0.000 {built-in method math.ceil}
        4    0.000    0.000    0.000    0.000 selectors.py:275(_key_from_fd)
        4    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        4    0.000    0.000    0.000    0.000 connection.py:933(<listcomp>)
        4    0.000    0.000    0.000    0.000 {built-in method posix.WIFSIGNALED}
        4    0.000    0.000    0.000    0.000 {method 'register' of 'select.poll' objects}
        4    0.000    0.000    0.000    0.000 selectors.py:63(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method select.poll}
        4    0.000    0.000    0.000    0.000 {built-in method posix.WIFEXITED}
        4    0.000    0.000    0.000    0.000 {built-in method posix.WEXITSTATUS}
        4    0.000    0.000    0.000    0.000 selectors.py:199(__enter__)
        2    0.000    0.000    0.000    0.000 threading.py:1306(current_thread)
        1    0.000    0.000    0.000    0.000 threading.py:505(__init__)
        5    0.000    0.000    0.000    0.000 util.py:44(sub_debug)
        5    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        5    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {method '__exit__' of '_multiprocessing.SemLock' objects}
        4    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        1    0.000    0.000    0.000    0.000 threading.py:1110(daemon)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._remove_worker_pids}
        2    0.000    0.000    0.000    0.000 threading.py:1095(daemon)
        2    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 threading.py:222(__init__)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 util.py:229(cancel)
        1    0.000    0.000    0.000    0.000 {method 'locked' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 threading.py:1177(_make_invoke_excepthook)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'clear' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 {method '_is_mine' of '_multiprocessing.SemLock' objects}



Profile stats for: on_train_epoch_end
         72203 function calls (71934 primitive calls) in 3.227 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    3.227    3.227 callback_hook.py:90(on_train_epoch_end)
        1    0.000    0.000    3.195    3.195 model_checkpoint.py:311(on_train_epoch_end)
        1    0.000    0.000    3.194    3.194 model_checkpoint.py:376(save_checkpoint)
        1    0.000    0.000    3.173    3.173 model_checkpoint.py:689(_save_none_monitor_checkpoint)
        1    0.000    0.000    3.168    3.168 trainer.py:1912(save_checkpoint)
        1    0.000    0.000    3.168    3.168 checkpoint_connector.py:470(save_checkpoint)
        1    0.000    0.000    3.128    3.128 training_type_plugin.py:286(save_checkpoint)
        1    0.020    0.020    3.128    3.128 torch_plugin.py:32(save_checkpoint)
        1    0.000    0.000    3.108    3.108 cloud_io.py:50(atomic_save)
        1    0.001    0.001    2.357    2.357 serialization.py:333(save)
        1    1.196    1.196    2.356    2.356 serialization.py:450(_save)
        1    0.000    0.000    0.741    0.741 local.py:316(write)
        1    0.741    0.741    0.741    0.741 {method 'write' of '_io.BufferedWriter' objects}
        1    0.134    0.134    0.683    0.683 {method 'dump' of '_pickle.Pickler' objects}
      726    0.021    0.000    0.457    0.001 storage.py:70(cpu)
    16540    0.256    0.000    0.437    0.000 serialization.py:453(persistent_id)
      726    0.042    0.000    0.430    0.001 __init__.py:491(type)
      726    0.043    0.000    0.210    0.000 _utils.py:11(_type)
      666    0.139    0.000    0.139    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
    16540    0.120    0.000    0.120    0.000 __init__.py:271(is_storage)
      728    0.011    0.000    0.113    0.000 tensor.py:93(__reduce_ex__)
      737    0.013    0.000    0.107    0.000 __init__.py:216(__init__)
      728    0.050    0.000    0.102    0.000 tensor.py:103(_reduce_ex_internal)
      737    0.032    0.000    0.094    0.000 _utils.py:8(_get_device_index)
      737    0.020    0.000    0.059    0.000 __init__.py:220(__enter__)
     5610    0.046    0.000    0.047    0.000 {built-in method builtins.isinstance}
      737    0.025    0.000    0.043    0.000 _utils.py:462(_get_device_index)
        1    0.000    0.000    0.040    0.040 checkpoint_connector.py:341(dump_checkpoint)
      728    0.017    0.000    0.040    0.000 serialization.py:164(location_tag)
      748    0.013    0.000    0.032    0.000 __init__.py:144(_lazy_init)
        1    0.000    0.000    0.026    0.026 checkpoint_connector.py:480(_get_lightning_module_state_dict)
        1    0.000    0.000    0.025    0.025 training_type_plugin.py:281(lightning_module_state_dict)
    189/1    0.008    0.000    0.025    0.025 module.py:1053(state_dict)
        1    0.000    0.000    0.025    0.025 tqdm_progress.py:239(on_train_epoch_end)
        1    0.000    0.000    0.021    0.021 std.py:1429(set_postfix)
        1    0.000    0.000    0.020    0.020 std.py:1360(refresh)
        1    0.000    0.000    0.020    0.020 std.py:1491(display)
      748    0.013    0.000    0.019    0.000 __init__.py:107(is_initialized)
        3    0.000    0.000    0.018    0.006 utils.py:325(disp_len)
        3    0.000    0.000    0.018    0.006 utils.py:320(_text_width)
        4    0.005    0.001    0.018    0.005 {built-in method builtins.sum}
      726    0.012    0.000    0.017    0.000 serialization.py:121(_cuda_tag)
        1    0.000    0.000    0.017    0.017 model_checkpoint.py:660(_monitor_candidates)
      728    0.011    0.000    0.016    0.000 _namedtensor_internals.py:10(check_serializing_named_tensor)
      728    0.011    0.000    0.016    0.000 serialization.py:183(normalize_storage_type)
        1    0.000    0.000    0.015    0.015 std.py:1126(__repr__)
      189    0.007    0.000    0.015    0.000 module.py:1019(_save_to_state_dict)
        1    0.000    0.000    0.015    0.015 std.py:343(format_meter)
        4    0.000    0.000    0.014    0.004 logger_connector.py:317(metrics)
      573    0.009    0.000    0.014    0.000 utils.py:321(<genexpr>)
     27/1    0.001    0.000    0.013    0.013 copy.py:128(deepcopy)
      3/1    0.000    0.000    0.013    0.013 copy.py:226(_deepcopy_dict)
        1    0.000    0.000    0.013    0.013 accelerator.py:388(optimizer_state)
        1    0.000    0.000    0.013    0.013 accelerator.py:393(<lambda>)
        1    0.000    0.000    0.013    0.013 optimizer.py:97(state_dict)
     1473    0.012    0.000    0.012    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.012    0.004 trainer.py:2139(callback_metrics)
        3    0.000    0.000    0.012    0.004 logger_connector.py:335(callback_metrics)
     1343    0.011    0.000    0.011    0.000 {method 'get_device' of 'torch._C.CudaFloatStorageBase' objects}
     1343    0.011    0.000    0.011    0.000 {method 'size' of 'torch._C.CudaFloatStorageBase' objects}
        4    0.001    0.000    0.011    0.003 result.py:555(metrics)
       11    0.002    0.000    0.010    0.001 tensor.py:51(__deepcopy__)
        2    0.000    0.000    0.009    0.004 re.py:289(_compile)
        2    0.000    0.000    0.008    0.004 sre_compile.py:759(compile)
        1    0.000    0.000    0.008    0.008 core.py:412(open)
      737    0.008    0.000    0.008    0.000 {built-in method torch._C._cuda_getDevice}
        1    0.000    0.000    0.008    0.008 core.py:225(open_files)
    56/24    0.002    0.000    0.008    0.000 apply_func.py:70(apply_to_collection)
        1    0.000    0.000    0.007    0.007 optimizer.py:118(<listcomp>)
        1    0.000    0.000    0.007    0.007 optimizer.py:110(pack_group)
        1    0.000    0.000    0.007    0.007 utils.py:333(disp_trim)
        1    0.000    0.000    0.007    0.007 core.py:567(get_fs_token_paths)
      737    0.007    0.000    0.007    0.000 __init__.py:228(__exit__)
        1    0.000    0.000    0.007    0.007 early_stopping.py:186(on_train_epoch_end)
      748    0.006    0.000    0.006    0.000 {built-in method torch._C._cuda_isInBadFork}
      739    0.006    0.000    0.006    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      739    0.006    0.000    0.006    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
      737    0.006    0.000    0.006    0.000 storage.py:13(__init__)
      726    0.006    0.000    0.006    0.000 _utils.py:83(_get_async_or_non_blocking)
        1    0.000    0.000    0.006    0.006 early_stopping.py:196(_run_early_stopping_check)
      670    0.006    0.000    0.006    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
      668    0.006    0.000    0.006    0.000 {method 'element_size' of 'torch._C.FloatStorageBase' objects}
      668    0.006    0.000    0.006    0.000 {method 'data_ptr' of 'torch._C.FloatStorageBase' objects}
      728    0.006    0.000    0.006    0.000 {method 'has_names' of 'torch._C._TensorBase' objects}
      751    0.006    0.000    0.006    0.000 {built-in method torch._C._has_torch_function_unary}
      728    0.006    0.000    0.006    0.000 hooks.py:55(warn_if_has_hooks)
      739    0.006    0.000    0.006    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
      739    0.006    0.000    0.006    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
      728    0.005    0.000    0.005    0.000 serialization.py:116(_cpu_tag)
      795    0.005    0.000    0.005    0.000 {built-in method builtins.id}
       11    0.000    0.000    0.005    0.000 storage.py:44(__deepcopy__)
        1    0.003    0.003    0.005    0.005 optimizer.py:120(<dictcomp>)
      378    0.005    0.000    0.005    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        1    0.003    0.003    0.005    0.005 optimizer.py:113(<dictcomp>)
        1    0.000    0.000    0.005    0.005 model_checkpoint.py:648(_get_metric_interpolated_filepath_name)
       11    0.001    0.000    0.005    0.000 storage.py:60(clone)
        1    0.000    0.000    0.005    0.005 std.py:336(print_status)
      2/1    0.000    0.000    0.005    0.005 core.py:324(_un_chain)
        1    0.000    0.000    0.005    0.005 core.py:326(<listcomp>)
        1    0.000    0.000    0.005    0.005 re.py:250(compile)
      570    0.005    0.000    0.005    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.005    0.005 model_checkpoint.py:550(format_checkpoint_name)
       12    0.000    0.000    0.004    0.000 trainer.py:2151(_results)
        1    0.000    0.000    0.004    0.004 model_checkpoint.py:520(_format_checkpoint_name)
        2    0.000    0.000    0.004    0.002 sre_parse.py:937(parse)
        1    0.000    0.000    0.004    0.004 re.py:233(findall)
      567    0.004    0.000    0.004    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.004    0.004 base.py:185(get_metrics)
      3/2    0.000    0.000    0.004    0.002 sre_parse.py:435(_parse_sub)
      3/2    0.001    0.000    0.004    0.002 sre_parse.py:493(_parse)
        1    0.000    0.000    0.004    0.004 model_checkpoint.py:633(_validate_monitor_key)
        1    0.000    0.000    0.003    0.003 trainer.py:2147(progress_bar_metrics)
        1    0.000    0.000    0.003    0.003 logger_connector.py:349(progress_bar_metrics)
        2    0.000    0.000    0.003    0.002 sre_compile.py:598(_code)
       60    0.003    0.000    0.003    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
       24    0.000    0.000    0.003    0.000 trainer.py:1957(training)
       26    0.001    0.000    0.003    0.000 enums.py:30(__eq__)
      7/2    0.001    0.000    0.002    0.001 sre_compile.py:71(_compile)
       24    0.001    0.000    0.002    0.000 result.py:519(_get_cache)
        1    0.001    0.001    0.002    0.002 optimizer.py:115(<listcomp>)
       12    0.000    0.000    0.002    0.000 fit_loop.py:142(_results)
       12    0.000    0.000    0.002    0.000 trainer.py:2126(_active_loop)
       28    0.001    0.000    0.001    0.000 result.py:347(meta)
      189    0.001    0.000    0.001    0.000 {method 'values' of 'collections.OrderedDict' objects}
       52    0.001    0.000    0.001    0.000 types.py:171(__get__)
      126    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
        4    0.000    0.000    0.001    0.000 result.py:544(_forked_name)
       11    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.001    0.001 registry.py:199(get_filesystem_class)
      120    0.001    0.000    0.001    0.000 {method 'get_device' of 'torch._C.CudaLongStorageBase' objects}
       38    0.001    0.000    0.001    0.000 sre_parse.py:164(__getitem__)
    92/85    0.001    0.000    0.001    0.000 {built-in method builtins.len}
        7    0.000    0.000    0.001    0.000 local.py:182(_strip_protocol)
      120    0.001    0.000    0.001    0.000 {method 'size' of 'torch._C.CudaLongStorageBase' objects}
        2    0.000    0.000    0.001    0.000 sre_compile.py:536(_compile_info)
       22    0.001    0.000    0.001    0.000 grad_mode.py:200(__init__)
       36    0.001    0.000    0.001    0.000 abc.py:96(__instancecheck__)
       11    0.000    0.000    0.001    0.000 __init__.py:479(_lazy_new)
        1    0.000    0.000    0.001    0.001 registry.py:229(_import_class)
        2    0.000    0.000    0.001    0.000 local.py:45(makedirs)
        1    0.000    0.000    0.001    0.001 callback_hook.py:258(on_save_checkpoint)
        4    0.000    0.000    0.001    0.000 result.py:281(wrapped_func)
        1    0.000    0.000    0.001    0.001 __init__.py:109(import_module)
       11    0.000    0.000    0.001    0.000 grad_mode.py:119(__enter__)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:1002(_gcd_import)
       11    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       16    0.000    0.000    0.001    0.000 result.py:538(<genexpr>)
        1    0.000    0.000    0.001    0.001 <frozen importlib._bootstrap>:986(_find_and_load)
        4    0.000    0.000    0.001    0.000 result.py:255(compute)
        1    0.000    0.000    0.001    0.001 early_stopping.py:216(_evaluate_stopping_criteria)
       11    0.000    0.000    0.001    0.000 grad_mode.py:123(__exit__)
        1    0.000    0.000    0.001    0.001 core.py:100(__enter__)
       12    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
        8    0.000    0.000    0.001    0.000 apply_func.py:65(_is_dataclass_instance)
       14    0.000    0.000    0.001    0.000 copy.py:242(_keep_alive)
        1    0.000    0.000    0.001    0.001 spec.py:954(open)
        8    0.000    0.000    0.001    0.000 result.py:64(should)
       60    0.001    0.000    0.001    0.000 {method 'element_size' of 'torch._C.LongStorageBase' objects}
       11    0.001    0.000    0.001    0.000 {method 'copy_' of 'torch._C.CudaFloatStorageBase' objects}
       63    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
       60    0.001    0.000    0.001    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}
        2    0.000    0.000    0.001    0.000 os.py:198(makedirs)
       60    0.001    0.000    0.001    0.000 {method 'data_ptr' of 'torch._C.LongStorageBase' objects}
        1    0.000    0.000    0.000    0.000 core.py:305(<listcomp>)
        2    0.000    0.000    0.000    0.000 spec.py:53(__call__)
       12    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        8    0.000    0.000    0.000    0.000 dataclasses.py:1045(is_dataclass)
       17    0.000    0.000    0.000    0.000 sre_parse.py:254(get)
        2    0.000    0.000    0.000    0.000 sre_compile.py:276(_optimize_charset)
        8    0.000    0.000    0.000    0.000 result.py:90(_generate_sync_fn)
        1    0.000    0.000    0.000    0.000 lightning.py:1791(get_progress_bar_dict)
        1    0.000    0.000    0.000    0.000 version.py:292(__init__)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:754(file_exists)
        1    0.000    0.000    0.000    0.000 base.py:217(get_standard_metrics)
        2    0.000    0.000    0.000    0.000 utils.py:214(_is_ascii)
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:41(format_num)
        1    0.000    0.000    0.000    0.000 local.py:151(_open)
      8/3    0.000    0.000    0.000    0.000 sre_parse.py:174(getwidth)
       52    0.000    0.000    0.000    0.000 enum.py:689(value)
       52    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        7    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
        4    0.000    0.000    0.000    0.000 sre_compile.py:423(_simple)
       15    0.000    0.000    0.000    0.000 sre_parse.py:160(__len__)
        2    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
       11    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       11    0.000    0.000    0.000    0.000 tensor.py:906(grad)
       36    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       11    0.000    0.000    0.000    0.000 grad_mode.py:114(__init__)
        3    0.000    0.000    0.000    0.000 metric.py:513(state_dict)
       29    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 std.py:282(format_num)
        1    0.000    0.000    0.000    0.000 spec.py:553(exists)
       33    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
        2    0.000    0.000    0.000    0.000 sre_compile.py:249(_compile_charset)
        1    0.000    0.000    0.000    0.000 early_stopping.py:181(_should_skip_check)
       10    0.000    0.000    0.000    0.000 sre_parse.py:286(tell)
        2    0.000    0.000    0.000    0.000 imports.py:138(_fault_tolerant_training)
       11    0.000    0.000    0.000    0.000 {method 'new' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 local.py:65(info)
        1    0.000    0.000    0.000    0.000 {built-in method isfinite}
        1    0.000    0.000    0.000    0.000 core.py:121(__exit__)
        9    0.000    0.000    0.000    0.000 utils.py:290(stringify_path)
        1    0.000    0.000    0.000    0.000 supporters.py:93(mean)
        1    0.000    0.000    0.000    0.000 cloud_io.py:41(get_filesystem)
        1    0.000    0.000    0.000    0.000 serialization.py:258(__exit__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
        1    0.000    0.000    0.000    0.000 core.py:153(close)
        1    0.000    0.000    0.000    0.000 local.py:240(__init__)
       26    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
        2    0.000    0.000    0.000    0.000 enum.py:858(__and__)
        1    0.000    0.000    0.000    0.000 supporters.py:105(_agg_memory)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
       23    0.000    0.000    0.000    0.000 sre_parse.py:233(__next)
        2    0.000    0.000    0.000    0.000 os.py:766(getenv)
        1    0.000    0.000    0.000    0.000 core.py:304(<setcomp>)
       28    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
       28    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        6    0.000    0.000    0.000    0.000 sre_parse.py:81(groups)
       11    0.000    0.000    0.000    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 posixpath.py:100(split)
        1    0.000    0.000    0.000    0.000 core.py:217(_close)
        1    0.000    0.000    0.000    0.000 core.py:634(<listcomp>)
        1    0.000    0.000    0.000    0.000 local.py:174(_parent)
       12    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55a3dc5c3580}
        2    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
       20    0.000    0.000    0.000    0.000 result.py:142(sync)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        2    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.BytesIO' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
       14    0.000    0.000    0.000    0.000 sre_parse.py:249(match)
        8    0.000    0.000    0.000    0.000 apply_func.py:60(_is_namedtuple)
        2    0.000    0.000    0.000    0.000 _collections_abc.py:657(get)
       23    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 local.py:252(_open)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       23    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       22    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        1    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
        7    0.000    0.000    0.000    0.000 sre_parse.py:172(append)
        4    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
        2    0.000    0.000    0.000    0.000 std.py:260(format_interval)
       21    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      3/2    0.000    0.000    0.000    0.000 sre_compile.py:461(_get_literal_prefix)
        2    0.000    0.000    0.000    0.000 utils.py:270(tokenize)
        1    0.000    0.000    0.000    0.000 serialization.py:263(_open_zipfile_writer)
        1    0.000    0.000    0.000    0.000 {built-in method io.open}
       10    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        6    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       17    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 posixpath.py:150(dirname)
        2    0.000    0.000    0.000    0.000 os.py:670(__getitem__)
        1    0.000    0.000    0.000    0.000 core.py:530(expand_paths_if_needed)
        1    0.000    0.000    0.000    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 sre_parse.py:224(__init__)
       16    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
        1    0.000    0.000    0.000    0.000 {built-in method gt}
        1    0.000    0.000    0.000    0.000 std.py:330(fp_write)
        5    0.000    0.000    0.000    0.000 {built-in method posix.stat}
       16    0.000    0.000    0.000    0.000 result.py:570(any_tensor)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:254(state_key)
        4    0.000    0.000    0.000    0.000 enum.py:289(__call__)
        1    0.000    0.000    0.000    0.000 tensor.py:540(__format__)
        1    0.000    0.000    0.000    0.000 posixpath.py:71(join)
        3    0.000    0.000    0.000    0.000 trainer.py:2031(global_step)
       11    0.000    0.000    0.000    0.000 _jit_internal.py:833(is_scripting)
        1    0.000    0.000    0.000    0.000 sre_parse.py:96(closegroup)
        2    0.000    0.000    0.000    0.000 base.py:51(_generate_state_key)
        2    0.000    0.000    0.000    0.000 sre_parse.py:432(_uniq)
        4    0.000    0.000    0.000    0.000 result.py:536(valid_items)
        4    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        5    0.000    0.000    0.000    0.000 std.py:1455(<genexpr>)
        1    0.000    0.000    0.000    0.000 sre_parse.py:84(opengroup)
        1    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        2    0.000    0.000    0.000    0.000 config.py:66(apply_config)
        4    0.000    0.000    0.000    0.000 sre_compile.py:595(isstring)
       13    0.000    0.000    0.000    0.000 copy.py:182(_deepcopy_atomic)
        4    0.000    0.000    0.000    0.000 result.py:157(forked_name)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
        8    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
        1    0.000    0.000    0.000    0.000 serialization.py:228(_open_file_like)
        1    0.000    0.000    0.000    0.000 std.py:189(__format__)
        2    0.000    0.000    0.000    0.000 utils.py:141(inner)
        1    0.000    0.000    0.000    0.000 sre_parse.py:355(_escape)
       12    0.000    0.000    0.000    0.000 base.py:54(trainer)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.all}
        2    0.000    0.000    0.000    0.000 genericpath.py:39(isdir)
        1    0.000    0.000    0.000    0.000 serialization.py:254(__init__)
       12    0.000    0.000    0.000    0.000 result.py:60(should)
        1    0.000    0.000    0.000    0.000 core.py:307(<listcomp>)
       11    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        2    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
       11    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 core.py:207(__getitem__)
        1    0.000    0.000    0.000    0.000 early_stopping.py:140(_validate_condition_metric)
        1    0.000    0.000    0.000    0.000 early_stopping.py:130(state_key)
        2    0.000    0.000    0.000    0.000 os.py:748(encode)
        2    0.000    0.000    0.000    0.000 serialization.py:193(_is_path)
        1    0.000    0.000    0.000    0.000 {method 'squeeze' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 sre_parse.py:921(fix_flags)
        1    0.000    0.000    0.000    0.000 sre_parse.py:295(_class_escape)
        8    0.000    0.000    0.000    0.000 {method 'find' of 'bytearray' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        7    0.000    0.000    0.000    0.000 sre_parse.py:111(__init__)
        1    0.000    0.000    0.000    0.000 trainer.py:1777(is_global_zero)
        1    0.000    0.000    0.000    0.000 registry.py:43(register_implementation)
        8    0.000    0.000    0.000    0.000 result.py:97(__call__)
       10    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        8    0.000    0.000    0.000    0.000 result.py:70(op)
        8    0.000    0.000    0.000    0.000 result.py:80(group)
        8    0.000    0.000    0.000    0.000 single_device.py:45(reduce)
        6    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        3    0.000    0.000    0.000    0.000 {built-in method posix.getcwd}
        2    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
        2    0.000    0.000    0.000    0.000 base.py:126(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io._IOBase' objects}
        1    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
        1    0.000    0.000    0.000    0.000 core.py:601(<listcomp>)
        1    0.000    0.000    0.000    0.000 std.py:156(__init__)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:351(on_save_checkpoint)
        1    0.000    0.000    0.000    0.000 core.py:512(split_protocol)
        2    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 local.py:334(close)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:324(_update_bar)
        1    0.000    0.000    0.000    0.000 <string>:1(__new__)
        1    0.000    0.000    0.000    0.000 trainer.py:1623(global_rank)
        5    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        4    0.000    0.000    0.000    0.000 enum.py:586(__new__)
        4    0.000    0.000    0.000    0.000 typing_extensions.py:1603(_dict_new)
        4    0.000    0.000    0.000    0.000 version.py:303(<genexpr>)
        1    0.000    0.000    0.000    0.000 core.py:124(__del__)
        1    0.000    0.000    0.000    0.000 trainer.py:2047(max_steps)
        1    0.000    0.000    0.000    0.000 sre_compile.py:432(_generate_overlap_table)
        1    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)
        4    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        5    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        1    0.000    0.000    0.000    0.000 core.py:60(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
        4    0.000    0.000    0.000    0.000 sre_parse.py:168(__setitem__)
        4    0.000    0.000    0.000    0.000 result.py:299(__setattr__)
        4    0.000    0.000    0.000    0.000 result.py:162(is_mean_reduction)
        4    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
        4    0.000    0.000    0.000    0.000 sre_compile.py:453(_get_iscased)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.repr}
        1    0.000    0.000    0.000    0.000 utils.py:97(update_storage_options)
        1    0.000    0.000    0.000    0.000 version.py:495(_cmpkey)
        4    0.000    0.000    0.000    0.000 result.py:153(forked)
        3    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        4    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        4    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        1    0.000    0.000    0.000    0.000 local.py:348(__getattr__)
        1    0.000    0.000    0.000    0.000 sre_compile.py:492(_get_charset_prefix)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:937(_sanity_check)
        1    0.000    0.000    0.000    0.000 {method 'close' of '_io.BufferedWriter' objects}
        1    0.000    0.000    0.000    0.000 serialization.py:224(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        1    0.000    0.000    0.000    0.000 spec.py:143(_fs_token)
        2    0.000    0.000    0.000    0.000 local.py:337(closed)
        1    0.000    0.000    0.000    0.000 trainer.py:1703(lr_schedulers)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        2    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
        3    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 hooks.py:802(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {built-in method _sre.compile}
        3    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1619(precision_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method fromkeys}
        2    0.000    0.000    0.000    0.000 sre_parse.py:76(__init__)
        1    0.000    0.000    0.000    0.000 early_stopping.py:159(monitor_op)
        2    0.000    0.000    0.000    0.000 registry.py:36(__contains__)
        2    0.000    0.000    0.000    0.000 serialization.py:199(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        1    0.000    0.000    0.000    0.000 early_stopping.py:163(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        2    0.000    0.000    0.000    0.000 {method 'rsplit' of 'str' objects}
        3    0.000    0.000    0.000    0.000 version.py:441(_parse_letter_version)
        2    0.000    0.000    0.000    0.000 {method 'flush' of '_io.BytesIO' objects}
        1    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
        2    0.000    0.000    0.000    0.000 core.py:504(get_compression)
        2    0.000    0.000    0.000    0.000 core.py:627(<genexpr>)
        2    0.000    0.000    0.000    0.000 core.py:636(<genexpr>)
        3    0.000    0.000    0.000    0.000 base.py:283(on_save_checkpoint)
        1    0.000    0.000    0.000    0.000 {method 'findall' of 're.Pattern' objects}
        2    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
        2    0.000    0.000    0.000    0.000 fit_loop.py:70(global_step)
        2    0.000    0.000    0.000    0.000 sre_compile.py:65(_combine_flags)
        2    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
        2    0.000    0.000    0.000    0.000 {method 'clear' of 'list' objects}
        2    0.000    0.000    0.000    0.000 spec.py:55(<genexpr>)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        1    0.000    0.000    0.000    0.000 optimizer.py:112(<dictcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 core.py:170(__init__)
        1    0.000    0.000    0.000    0.000 {method '__format__' of 'float' objects}
        2    0.000    0.000    0.000    0.000 serialization.py:202(__enter__)
        1    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 serialization.py:314(_check_dill_version)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        1    0.000    0.000    0.000    0.000 registry.py:24(__getitem__)
        1    0.000    0.000    0.000    0.000 std.py:170(colour)
        1    0.000    0.000    0.000    0.000 core.py:547(<listcomp>)
        1    0.000    0.000    0.000    0.000 spec.py:178(_get_kwargs_from_urls)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:665(_save_last_checkpoint)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {function OpenFiles.__getitem__ at 0x7fe5c88c80d0}
        1    0.000    0.000    0.000    0.000 fit_loop.py:123(running_loss)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:676(_save_top_k_checkpoint)
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:42(checkpoint_io)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 fit_loop.py:102(max_steps)
        1    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 utilities.py:173(_is_max_limit_reached)
        1    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:152(reduce_boolean_decision)
        1    0.000    0.000    0.000    0.000 hooks.py:193(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 std.py:166(colour)
        1    0.000    0.000    0.000    0.000 base.py:75(after_save_checkpoint)
        1    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        1    0.000    0.000    0.000    0.000 version.py:511(<lambda>)
        1    0.000    0.000    0.000    0.000 version.py:361(release)
        1    0.000    0.000    0.000    0.000 version.py:482(_parse_local_version)



Profile stats for: on_train_end
         1340 function calls in 0.028 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.028    0.028 callback_hook.py:140(on_train_end)
        1    0.000    0.000    0.027    0.027 tqdm_progress.py:244(on_train_end)
        1    0.000    0.000    0.027    0.027 std.py:1304(close)
        1    0.000    0.000    0.025    0.025 std.py:1491(display)
        3    0.000    0.000    0.023    0.008 utils.py:325(disp_len)
        3    0.000    0.000    0.023    0.008 utils.py:320(_text_width)
        3    0.005    0.002    0.023    0.008 {built-in method builtins.sum}
        1    0.000    0.000    0.020    0.020 std.py:1126(__repr__)
        1    0.000    0.000    0.019    0.019 std.py:343(format_meter)
      573    0.012    0.000    0.017    0.000 utils.py:321(<genexpr>)
        1    0.000    0.000    0.008    0.008 utils.py:333(disp_trim)
        1    0.000    0.000    0.006    0.006 std.py:336(print_status)
      570    0.005    0.000    0.005    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.001    0.001 std.py:580(_decr_instances)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        2    0.000    0.000    0.000    0.000 utils.py:214(_is_ascii)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        1    0.000    0.000    0.000    0.000 std.py:1473(format_dict)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        8    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:335(on_train_end)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
        2    0.000    0.000    0.000    0.000 std.py:260(format_interval)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        1    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        2    0.000    0.000    0.000    0.000 std.py:1129(_comparable)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        4    0.000    0.000    0.000    0.000 utils.py:141(inner)
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        2    0.000    0.000    0.000    0.000 std.py:1321(fp_write)
       13    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        1    0.000    0.000    0.000    0.000 std.py:330(fp_write)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        3    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        7    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 std.py:189(__format__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        2    0.000    0.000    0.000    0.000 types.py:171(__get__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 std.py:1133(__hash__)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 trainer.py:2031(global_step)
        3    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 base.py:234(on_train_end)
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 std.py:156(__init__)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 enum.py:689(value)
        2    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        1    0.000    0.000    0.000    0.000 std.py:170(colour)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 std.py:166(colour)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:347(on_train_end)
        1    0.000    0.000    0.000    0.000 hooks.py:43(on_train_end)



Profile stats for: on_fit_end
         55 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:70(on_fit_end)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:87(on_fit_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:34(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: teardown
         52 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:50(teardown)
        5    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 base.py:71(teardown)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:399(teardown)


